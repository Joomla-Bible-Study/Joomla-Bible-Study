<?xml version="1.0" encoding="UTF-8"?>
<pmd-cpd>
  <duplication lines="38" tokens="87">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/liveupdate/classes/xmlslurp.php" line="133"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/liveupdate/classes/xmlslurp.php" line="237"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/liveupdate/classes/xmlslurp.php" line="298"/>
    <codefragment>        if (empty($filename))
        {
            return array('version' =&gt; '', 'date' =&gt; '', 'xmlfile' =&gt; '');
        }

        try
        {
            $xml = new SimpleXMLElement($filename, LIBXML_NONET, true);
        }
        catch (Exception $e)
        {
            return array('version' =&gt; '', 'date' =&gt; '', 'xmlfile' =&gt; '');
        }

        // Need to check for extension (since 1.6) and install (supported through 2.5)
        if ($xml-&gt;getName() != 'extension' &amp;&amp; $xml-&gt;getName() != 'install')
        {
            unset($xml);

            return array('version' =&gt; '', 'date' =&gt; '', 'xmlfile' =&gt; '');
        }

        $data['version'] = $xml-&gt;version ? (string) $xml-&gt;version : '';
        $data['date']    = $xml-&gt;creationDate ? (string) $xml-&gt;creationDate : '';
        $data['xmlfile'] = $filename;

        return $data;
    }

    /**
     * Gets the version information of a module by reading its XML file
     *
     * @param   string $extensionName  The name of the extension, e.g. mod_foobar
     * @param   string $xmlName        The name of the XML manifest filename. If empty uses $extensionName.xml
     *
     * @return array
     */
    private function getModuleData($extensionName, $xmlName)
</codefragment>
  </duplication>
  <duplication lines="41" tokens="89">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/liveupdate/classes/xmlslurp.php" line="298"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/liveupdate/classes/xmlslurp.php" line="371"/>
    <codefragment>        if (!JFile::exists($filename))
        {
            return array('version' =&gt; '', 'date' =&gt; '', 'xmlfile' =&gt; '');
        }

        try
        {
            $xml = new SimpleXMLElement($filename, LIBXML_NONET, true);
        }
        catch (Exception $e)
        {
            return array('version' =&gt; '', 'date' =&gt; '', 'xmlfile' =&gt; '');
        }

        // Need to check for extension (since 1.6) and install (supported through 2.5)
        if ($xml-&gt;getName() != 'extension' &amp;&amp; $xml-&gt;getName() != 'install')
        {
            unset($xml);

            return array('version' =&gt; '', 'date' =&gt; '', 'xmlfile' =&gt; '');
        }

        $data['version'] = $xml-&gt;version ? (string) $xml-&gt;version : '';
        $data['date']    = $xml-&gt;creationDate ? (string) $xml-&gt;creationDate : '';
        $data['xmlfile'] = $filename;

        return $data;
    }

    /**
     * Gets the version information of a template by reading its XML file
     *
     * @param   string $extensionName  The name of the template, e.g. tpl_foobar
     * @param   string $xmlName        The name of the XML manifest filename. If empty uses $extensionName.xml or templateDetails.xml
     *
     * @return array
     */
    private function getTemplateData($extensionName, $xmlName)
    {
        $extensionName    = strtolower($extensionName);
        $altExtensionName = substr($extensionName, 4);
</codefragment>
  </duplication>
  <duplication lines="31" tokens="78">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/liveupdate/classes/xmlslurp.php" line="221"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/liveupdate/classes/xmlslurp.php" line="420"/>
    <codefragment>            $filename = "$path/$xmlName";

            if (!JFile::exists($filename))
            {
                $filename = "$path/$extensionName.xml";
            }
            if (!JFile::exists($filename))
            {
                $filename = "$path/$altExtensionName.xml";
            }
            if (!JFile::exists($filename))
            {
                return array('version' =&gt; '', 'date' =&gt; '');
            }
        }

        if (empty($filename))
        {
            return array('version' =&gt; '', 'date' =&gt; '', 'xmlfile' =&gt; '');
        }

        try
        {
            $xml = new SimpleXMLElement($filename, LIBXML_NONET, true);
        }
        catch (Exception $e)
        {
            return array('version' =&gt; '', 'date' =&gt; '', 'xmlfile' =&gt; '');
        }

        // Need to check for extension (since 1.6) and install (supported through 2.5)
</codefragment>
  </duplication>
  <duplication lines="31" tokens="79">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/fields/modal/seriesdetail.php" line="40"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/fields/modal/studydetails.php" line="44"/>
    <codefragment>        JHtml::_('behavior.framework');
        JHTML::_('script', 'system/modal.js', false, true);
        JHTML::_('stylesheet', 'system/modal.css', array(), true);

        // Build the script.
        $script = array();
        $script[] = '    function jSelectChart_' . $this-&gt;id . '(id, name, object) {';
        $script[] = '        document.id("' . $this-&gt;id . '_id").value = id;';
        $script[] = '        document.id("' . $this-&gt;id . '_name").value = name;';
        $script[] = '        SqueezeBox.close();';
        $script[] = '    }';

        // Add the script to the document head.
        JFactory::getDocument()-&gt;addScriptDeclaration(implode("\n", $script));

        // Build the script.
        $script = array();
        $script[] = '    window.addEvent("domready", function() {';
        $script[] = '        var div = new Element("div").setStyle("display", "none").injectBefore(document.id("menu-types"));';
        $script[] = '        document.id("menu-types").injectInside(div);';
        $script[] = '        SqueezeBox.initialize();';
        $script[] = '        SqueezeBox.assign($$("input.modal"), {parse:"rel"});';
        $script[] = '    });';

        // Add the script to the document head.
        JFactory::getDocument()-&gt;addScriptDeclaration(implode("\n", $script));


        // Get the title of the linked chart
        $db = JFactory::getDBO();
        $db-&gt;setQuery(
</codefragment>
  </duplication>
  <duplication lines="35" tokens="87">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/fields/modal/studydetails.php" line="38"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/fields/modal/teacherdisplay.php" line="38"/>
    <codefragment>    protected function getInput() {

        // Load the modal behavior script.
        JHtml::_('behavior.modal', 'a.modal');

        // Load the javascript and css
        JHtml::_('behavior.framework');
        JHTML::_('script', 'system/modal.js', false, true);
        JHTML::_('stylesheet', 'system/modal.css', array(), true);

        // Build the script.
        $script = array();
        $script[] = '    function jSelectChart_' . $this-&gt;id . '(id, name, object) {';
        $script[] = '        document.id("' . $this-&gt;id . '_id").value = id;';
        $script[] = '        document.id("' . $this-&gt;id . '_name").value = name;';
        $script[] = '        SqueezeBox.close();';
        $script[] = '    }';

        // Add the script to the document head.
        JFactory::getDocument()-&gt;addScriptDeclaration(implode("\n", $script));

        // Build the script.
        $script = array();
        $script[] = '    window.addEvent("domready", function() {';
        $script[] = '        var div = new Element("div").setStyle("display", "none").injectBefore(document.id("menu-types"));';
        $script[] = '        document.id("menu-types").injectInside(div);';
        $script[] = '        SqueezeBox.initialize();';
        $script[] = '        SqueezeBox.assign($$("input.modal"), {parse:"rel"});';
        $script[] = '    });';

        // Add the script to the document head.
        JFactory::getDocument()-&gt;addScriptDeclaration(implode("\n", $script));


        // Get the title of the linked chart
</codefragment>
  </duplication>
  <duplication lines="56" tokens="73">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/location.php" line="21"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/messagetype.php" line="21"/>
    <codefragment>class BiblestudyModelLocation extends JModelAdmin
{

    /**
     * Method to store a record
     *
     * @access    public
     * @return    boolean    True on success
     */
    public function store()
    {
        $row   = &amp; $this-&gt;getTable();
        $input = new JInput;
        $data  = $input-&gt;get('post');

        // Bind the form fields to the table
        if (!$row-&gt;bind($data))
        {
            $this-&gt;setError($this-&gt;_db-&gt;getErrorMsg());

            return false;
        }

        // Make sure the record is valid
        if (!$row-&gt;check())
        {
            $this-&gt;setError($this-&gt;_db-&gt;getErrorMsg());

            return false;
        }

        // Store the web link table to the database
        if (!$row-&gt;store())
        {
            $this-&gt;setError($this-&gt;_db-&gt;getErrorMsg());

            return false;
        }

        return true;
    }

    /**
     * Get the form data
     *
     * @param   array   $data      Data for the form.
     * @param   boolean $loadData  True if the form is to load its own data (default case), false if not.
     *
     * @return  mixed  A JForm object on success, false on failure
     *
     * @since  7.0
     */
    public function getForm($data = array(), $loadData = true)
    {
        // Get the form.
        $form = $this-&gt;loadForm('com_biblestudy.location', 'location', array('control' =&gt; 'jform', 'load_data' =&gt; $loadData));
</codefragment>
  </duplication>
  <duplication lines="55" tokens="73">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/location.php" line="21"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/mimetype.php" line="21"/>
    <codefragment>class BiblestudyModelLocation extends JModelAdmin
{

    /**
     * Method to store a record
     *
     * @access    public
     * @return    boolean    True on success
     */
    public function store()
    {
        $row   = &amp; $this-&gt;getTable();
        $input = new JInput;
        $data  = $input-&gt;get('post');

        // Bind the form fields to the table
        if (!$row-&gt;bind($data))
        {
            $this-&gt;setError($this-&gt;_db-&gt;getErrorMsg());

            return false;
        }

        // Make sure the record is valid
        if (!$row-&gt;check())
        {
            $this-&gt;setError($this-&gt;_db-&gt;getErrorMsg());

            return false;
        }

        // Store the web link table to the database
        if (!$row-&gt;store())
        {
            $this-&gt;setError($this-&gt;_db-&gt;getErrorMsg());

            return false;
        }

        return true;
    }

    /**
     * Get the form data
     *
     * @param   array   $data      Data for the form.
     * @param   boolean $loadData  True if the form is to load its own data (default case), false if not.
     *
     * @return  mixed  A JForm object on success, false on failure
     *
     * @since  7.0
     */
    public function getForm($data = array(), $loadData = true)
    {
        // Get the form.
</codefragment>
  </duplication>
  <duplication lines="99" tokens="151">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/folder.php" line="21"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/serie.php" line="21"/>
    <codefragment>class BiblestudyModelFolder extends JModelAdmin
{

    /**
     * @var        string    The prefix to use with controller messages.
     * @since    1.6
     */
    protected $text_prefix = 'COM_BIBLESTUDY';

    /**
     * Batch copy items to a new category or current.
     *
     * @param   integer $value     The new category.
     * @param   array   $pks       An array of row IDs.
     * @param   array   $contexts  An array of item contexts.
     *
     * @return  mixed  An array of new IDs on success, boolean false on failure.
     *
     * @since    11.1
     */
    protected function batchCopy($value, $pks, $contexts)
    {
        $app   = JFactory::getApplication();
        $table = $this-&gt;getTable();
        $i     = 0;

        // Check that the user has create permission for the component
        $extension = $app-&gt;input-&gt;get('option', '');
        $user      = JFactory::getUser();

        if (!$user-&gt;authorise('core.create', $extension))
        {
            $app-&gt;enqueueMessage(JText::_('JLIB_APPLICATION_ERROR_BATCH_CANNOT_CREATE'), 'error');

            return false;
        }

        // Parent exists so we let's proceed
        while (!empty($pks))
        {
            // Pop the first ID off the stack
            $pk = array_shift($pks);

            $table-&gt;reset();

            // Check that the row actually exists
            if (!$table-&gt;load($pk))
            {
                if ($error = $table-&gt;getError())
                {
                    // Fatal error
                    $app-&gt;enqueueMessage($error, 'error');

                    return false;
                }
                else
                {
                    // Not fatal error
                    $app-&gt;enqueueMessage(JText::sprintf('JLIB_APPLICATION_ERROR_BATCH_MOVE_ROW_NOT_FOUND', $pk));
                    continue;
                }
            }

            // Alter the title &amp; alias
            $data         = $this-&gt;generateNewTitle('', $table-&gt;alias, $table-&gt;title);
            $table-&gt;title = $data['0'];
            $table-&gt;alias = $data['1'];

            // Reset the ID because we are making a copy
            $table-&gt;id = 0;

            // Check the row.
            if (!$table-&gt;check())
            {
                $app-&gt;enqueueMessage($table-&gt;getError(), 'error');

                return false;
            }

            // Store the row.
            if (!$table-&gt;store())
            {
                $app-&gt;enqueueMessage($table-&gt;getError(), 'error');

                return false;
            }

            // Get the new item ID
            $newId = $table-&gt;get('id');

            // Add the new ID to the array
            $newIds[$i] = $newId;
            $i++;
        }

        // Clean the cache
        $this-&gt;cleanCache();

        return $newIds;
</codefragment>
  </duplication>
  <duplication lines="47" tokens="71">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/location.php" line="30"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/share.php" line="67"/>
    <codefragment>    public function store()
    {
        $row   = &amp; $this-&gt;getTable();
        $input = new JInput;
        $data  = $input-&gt;get('post');

        // Bind the form fields to the table
        if (!$row-&gt;bind($data))
        {
            $this-&gt;setError($this-&gt;_db-&gt;getErrorMsg());

            return false;
        }

        // Make sure the record is valid
        if (!$row-&gt;check())
        {
            $this-&gt;setError($this-&gt;_db-&gt;getErrorMsg());

            return false;
        }

        // Store the web link table to the database
        if (!$row-&gt;store())
        {
            $this-&gt;setError($this-&gt;_db-&gt;getErrorMsg());

            return false;
        }

        return true;
    }

    /**
     * Get the form data
     *
     * @param   array   $data      Data for the form.
     * @param   boolean $loadData  True if the form is to load its own data (default case), false if not.
     *
     * @return  mixed  A JForm object on success, false on failure
     *
     * @since  7.0
     */
    public function getForm($data = array(), $loadData = true)
    {
        // Get the form.
        $form = $this-&gt;loadForm('com_biblestudy.location', 'location', array('control' =&gt; 'jform', 'load_data' =&gt; $loadData));
</codefragment>
  </duplication>
  <duplication lines="43" tokens="81">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comment/tmpl/edit.php" line="17"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/folder/tmpl/edit.php" line="14"/>
    <codefragment>JHtml::_('behavior.tooltip');
JHtml::_('behavior.formvalidation');
JHtml::_('behavior.keepalive');
if (BIBLESTUDY_CHECKREL)
    JHtml::_('formbehavior.chosen', 'select');

// Create shortcut to parameters.
$params = $this-&gt;state-&gt;get('params');
$params = $params-&gt;toArray();

$app = JFactory::getApplication();
$input = $app-&gt;input;
?&gt;

&lt;script type="text/javascript"&gt;
    Joomla.submitbutton = function (task) {
        if (task == 'comment.cancel' || document.formvalidator.isValid(document.id('item-form'))) {
            Joomla.submitform(task, document.getElementById('item-form'));
        } else {
            alert('&lt;?php echo $this-&gt;escape(JText::_('JGLOBAL_VALIDATION_FORM_FAILED')); ?&gt;');
        }
    }
&lt;/script&gt;
&lt;form action="&lt;?php echo JRoute::_('index.php?option=com_biblestudy&amp;layout=edit&amp;id=' . (int) $this-&gt;item-&gt;id); ?&gt;"
      method="post" name="adminForm" id="item-form" class="form-validate"&gt;
    &lt;div class="row-fluid"&gt;
        &lt;!-- Begin Content --&gt;
        &lt;div class="span10 form-horizontal"&gt;
            &lt;fieldset&gt;
                &lt;ul class="nav nav-tabs"&gt;
                    &lt;li class="active"&gt;&lt;a href="#general"
                                          data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_DETAILS'); ?&gt;&lt;/a&gt;
                    &lt;/li&gt;
                    &lt;?php if ($this-&gt;canDo-&gt;get('core.admin')): ?&gt;
                        &lt;li&gt;&lt;a href="#permissions"
                               data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_FIELDSET_RULES'); ?&gt;&lt;/a&gt;
                        &lt;/li&gt;
                    &lt;?php endif ?&gt;
                &lt;/ul&gt;
                &lt;div class="tab-content"&gt;
                    &lt;!-- Begin Tabs --&gt;
                    &lt;div class="tab-pane active" id="general"&gt;
                        &lt;div class="control-group"&gt;
</codefragment>
  </duplication>
  <duplication lines="17" tokens="77">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/tmpl/default.php" line="16"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/folders/tmpl/default.php" line="15"/>
    <codefragment>    JHtml::_('bootstrap.tooltip');
    JHtml::_('dropdown.init');
    JHtml::_('formbehavior.chosen', 'select');
}
else
{
    JHtml::_('behavior.tooltip');
}
JHtml::_('behavior.multiselect');

$app = JFactory::getApplication();
$user = JFactory::getUser();
$userId = $user-&gt;get('id');
$listOrder = $this-&gt;escape($this-&gt;state-&gt;get('list.ordering'));
$listDirn = $this-&gt;escape($this-&gt;state-&gt;get('list.direction'));
$archived = $this-&gt;state-&gt;get('filter.published') == 2 ? true : false;
$trashed = $this-&gt;state-&gt;get('filter.published') == -2 ? true : false;
</codefragment>
  </duplication>
  <duplication lines="53" tokens="161">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/view.html.php" line="75"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/folders/view.html.php" line="83"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/messages/view.html.php" line="128"/>
    <codefragment>        if (count($errors = $this-&gt;get('Errors')))
        {
            JFactory::getApplication()-&gt;enqueueMessage(implode("\n", $errors), 'error');

            return false;
        }

        // Levels filter.
        $options   = array();
        $options[] = JHtml::_('select.option', '1', JText::_('J1'));
        $options[] = JHtml::_('select.option', '2', JText::_('J2'));
        $options[] = JHtml::_('select.option', '3', JText::_('J3'));
        $options[] = JHtml::_('select.option', '4', JText::_('J4'));
        $options[] = JHtml::_('select.option', '5', JText::_('J5'));
        $options[] = JHtml::_('select.option', '6', JText::_('J6'));
        $options[] = JHtml::_('select.option', '7', JText::_('J7'));
        $options[] = JHtml::_('select.option', '8', JText::_('J8'));
        $options[] = JHtml::_('select.option', '9', JText::_('J9'));
        $options[] = JHtml::_('select.option', '10', JText::_('J10'));

        $this-&gt;f_levels = $options;

        // We don't need toolbar in the modal window.
        if ($this-&gt;getLayout() !== 'modal')
        {
            $this-&gt;addToolbar();

            if (BIBLESTUDY_CHECKREL)
            {
                $this-&gt;sidebar = JHtmlSidebar::render();
            }
        }

        // Set the document
        $this-&gt;setDocument();

        // Display the template
        return parent::display($tpl);
    }

    /**
     * Add the page title and toolbar
     *
     * @return void
     *
     * @since 7.0
     */
    protected function addToolbar()
    {
        $user = JFactory::getUser();

        // Get the toolbar object instance
        $bar   = JToolBar::getInstance('toolbar');
</codefragment>
  </duplication>
  <duplication lines="55" tokens="99">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/folder/tmpl/edit.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/location/tmpl/edit.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

// Load the tooltip behavior.
JHtml::_('behavior.tooltip');
JHtml::_('behavior.formvalidation');
JHtml::_('behavior.keepalive');
if (BIBLESTUDY_CHECKREL)
    JHtml::_('formbehavior.chosen', 'select');

// Create shortcut to parameters.
$params = $this-&gt;state-&gt;get('params');
$params = $params-&gt;toArray();
$app = JFactory::getApplication();
$input = $app-&gt;input;
?&gt;
&lt;script type="text/javascript"&gt;
    Joomla.submitbutton = function (task) {
        if (task == 'folder.cancel' || document.formvalidator.isValid(document.id('item-form'))) {
            Joomla.submitform(task, document.getElementById('item-form'));
        } else {
            alert('&lt;?php echo $this-&gt;escape(JText::_('JGLOBAL_VALIDATION_FORM_FAILED')); ?&gt;');
        }
    }
&lt;/script&gt;

&lt;form action="&lt;?php echo JRoute::_('index.php?option=com_biblestudy&amp;layout=edit&amp;id=' . (int) $this-&gt;item-&gt;id); ?&gt;"
      method="post" name="adminForm" id="item-form" class="form-validate"&gt;
    &lt;div class="row-fluid"&gt;
        &lt;!-- Begin Content --&gt;
        &lt;div class="span10 form-horizontal"&gt;
            &lt;ul class="nav nav-tabs"&gt;
                &lt;li class="active"&gt;&lt;a href="#general" data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_DETAILS'); ?&gt;&lt;/a&gt;
                &lt;/li&gt;

                &lt;?php if ($this-&gt;canDo-&gt;get('core.admin')): ?&gt;
                    &lt;li&gt;&lt;a href="#permissions" data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_FIELDSET_RULES'); ?&gt;&lt;/a&gt;
                    &lt;/li&gt;
                &lt;?php endif ?&gt;
            &lt;/ul&gt;
            &lt;div class="tab-content"&gt;
                &lt;!-- Begin Tabs --&gt;
                &lt;div class="tab-pane active" id="general"&gt;

                    &lt;div class="control-group"&gt;
                        &lt;div class="control-label"&gt;
                            &lt;?php echo $this-&gt;form-&gt;getLabel('id'); ?&gt;
                        &lt;/div&gt;
                        &lt;div class="controls"&gt;
                            &lt;?php echo $this-&gt;form-&gt;getInput('id'); ?&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;

                    &lt;div class="control-group"&gt;
                        &lt;div class="control-label"&gt;
                            &lt;?php echo $this-&gt;form-&gt;getLabel('foldername'); ?&gt;
</codefragment>
  </duplication>
  <duplication lines="38" tokens="93">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/folders/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/locations/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/messagetypes/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/mimetypes/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/podcasts/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/shares/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/templatecodes/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/templates/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/topics/tmpl/default.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

if (BIBLESTUDY_CHECKREL)
{
    JHtml::_('bootstrap.tooltip');
    JHtml::_('dropdown.init');
    JHtml::_('formbehavior.chosen', 'select');
}
else
{
    JHtml::_('behavior.tooltip');
}
JHtml::_('behavior.multiselect');

$app = JFactory::getApplication();
$user = JFactory::getUser();
$userId = $user-&gt;get('id');
$listOrder = $this-&gt;escape($this-&gt;state-&gt;get('list.ordering'));
$listDirn = $this-&gt;escape($this-&gt;state-&gt;get('list.direction'));
$archived = $this-&gt;state-&gt;get('filter.published') == 2 ? true : false;
$trashed = $this-&gt;state-&gt;get('filter.published') == -2 ? true : false;

$sortFields = $this-&gt;getSortFields();
?&gt;
&lt;script type="text/javascript"&gt;
    Joomla.orderTable = function () {
        table = document.getElementById("sortTable");
        direction = document.getElementById("directionTable");
        order = table.options[table.selectedIndex].value;
        if (order != '&lt;?php echo $listOrder; ?&gt;') {
            dirn = 'asc';
        } else {
            dirn = direction.options[direction.selectedIndex].value;
        }
        Joomla.tableOrdering(order, dirn, '');
    }
&lt;/script&gt;
&lt;form action="&lt;?php echo JRoute::_('index.php?option=com_biblestudy&amp;view=folders'); ?&gt;" method="post" name="adminForm"
</codefragment>
  </duplication>
  <duplication lines="54" tokens="167">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/view.html.php" line="75"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/locations/view.html.php" line="83"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/mediafiles/view.html.php" line="92"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/messagetypes/view.html.php" line="83"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/servers/view.html.php" line="74"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/teachers/view.html.php" line="77"/>
    <codefragment>        if (count($errors = $this-&gt;get('Errors')))
        {
            JFactory::getApplication()-&gt;enqueueMessage(implode("\n", $errors), 'error');

            return false;
        }

        // Levels filter.
        $options   = array();
        $options[] = JHtml::_('select.option', '1', JText::_('J1'));
        $options[] = JHtml::_('select.option', '2', JText::_('J2'));
        $options[] = JHtml::_('select.option', '3', JText::_('J3'));
        $options[] = JHtml::_('select.option', '4', JText::_('J4'));
        $options[] = JHtml::_('select.option', '5', JText::_('J5'));
        $options[] = JHtml::_('select.option', '6', JText::_('J6'));
        $options[] = JHtml::_('select.option', '7', JText::_('J7'));
        $options[] = JHtml::_('select.option', '8', JText::_('J8'));
        $options[] = JHtml::_('select.option', '9', JText::_('J9'));
        $options[] = JHtml::_('select.option', '10', JText::_('J10'));

        $this-&gt;f_levels = $options;

        // We don't need toolbar in the modal window.
        if ($this-&gt;getLayout() !== 'modal')
        {
            $this-&gt;addToolbar();

            if (BIBLESTUDY_CHECKREL)
            {
                $this-&gt;sidebar = JHtmlSidebar::render();
            }
        }

        // Set the document
        $this-&gt;setDocument();

        // Display the template
        return parent::display($tpl);
    }

    /**
     * Add the page title and toolbar
     *
     * @return void
     *
     * @since 7.0
     */
    protected function addToolbar()
    {
        $user = JFactory::getUser();

        // Get the toolbar object instance
        $bar   = JToolBar::getInstance('toolbar');
        $canDo = JBSMBibleStudyHelper::getActions('', 'comment');
</codefragment>
  </duplication>
  <duplication lines="23" tokens="91">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/mediafiles/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/teachers/tmpl/default.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

if (BIBLESTUDY_CHECKREL)
{
    JHtml::addIncludePath(JPATH_COMPONENT . '/helpers/html');
    JHtml::_('bootstrap.tooltip');
    JHtml::_('dropdown.init');
    JHtml::_('formbehavior.chosen', 'select');
}
else
{
    JHtml::_('behavior.tooltip');
}
JHtml::_('behavior.multiselect');

$app = JFactory::getApplication();
$user = JFactory::getUser();
$userId = $user-&gt;get('id');
$listOrder = $this-&gt;escape($this-&gt;state-&gt;get('list.ordering'));
$listDirn = $this-&gt;escape($this-&gt;state-&gt;get('list.direction'));
$archived = $this-&gt;state-&gt;get('filter.published') == 2 ? true : false;
$trashed = $this-&gt;state-&gt;get('filter.published') == -2 ? true : false;
$saveOrder = $listOrder == 'ordering';
</codefragment>
  </duplication>
  <duplication lines="39" tokens="98">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/mediaimages/tmpl/default.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

if (BIBLESTUDY_CHECKREL)
{
    JHtml::addIncludePath(JPATH_COMPONENT . '/helpers/html');
    JHtml::_('bootstrap.tooltip');
    JHtml::_('dropdown.init');
    JHtml::_('formbehavior.chosen', 'select');
}
else
{
    JHtml::_('behavior.tooltip');
}
JHtml::_('behavior.multiselect');

$app = JFactory::getApplication();
$user = JFactory::getUser();
$userId = $user-&gt;get('id');
$listOrder = $this-&gt;escape($this-&gt;state-&gt;get('list.ordering'));
$listDirn = $this-&gt;escape($this-&gt;state-&gt;get('list.direction'));
$archived = $this-&gt;state-&gt;get('filter.published') == 2 ? true : false;
$trashed = $this-&gt;state-&gt;get('filter.published') == -2 ? true : false;
$saveOrder = $listOrder == 'ordering';
$sortFields = $this-&gt;getSortFields();
?&gt;
&lt;script type="text/javascript"&gt;
    Joomla.orderTable = function () {
        table = document.getElementById("sortTable");
        direction = document.getElementById("directionTable");
        order = table.options[table.selectedIndex].value;
        if (order != '&lt;?php echo $listOrder; ?&gt;') {
            dirn = 'asc';
        } else {
            dirn = direction.options[direction.selectedIndex].value;
        }
        Joomla.tableOrdering(order, dirn, '');
    }
&lt;/script&gt;
&lt;form action="&lt;?php echo JRoute::_('index.php?option=com_biblestudy&amp;view=comments'); ?&gt;" method="post" name="adminForm"
</codefragment>
  </duplication>
  <duplication lines="48" tokens="152">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/view.html.php" line="75"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/mediaimages/view.html.php" line="99"/>
    <codefragment>        if (count($errors = $this-&gt;get('Errors')))
        {
            JFactory::getApplication()-&gt;enqueueMessage(implode("\n", $errors), 'error');

            return false;
        }

        // Levels filter.
        $options   = array();
        $options[] = JHtml::_('select.option', '1', JText::_('J1'));
        $options[] = JHtml::_('select.option', '2', JText::_('J2'));
        $options[] = JHtml::_('select.option', '3', JText::_('J3'));
        $options[] = JHtml::_('select.option', '4', JText::_('J4'));
        $options[] = JHtml::_('select.option', '5', JText::_('J5'));
        $options[] = JHtml::_('select.option', '6', JText::_('J6'));
        $options[] = JHtml::_('select.option', '7', JText::_('J7'));
        $options[] = JHtml::_('select.option', '8', JText::_('J8'));
        $options[] = JHtml::_('select.option', '9', JText::_('J9'));
        $options[] = JHtml::_('select.option', '10', JText::_('J10'));

        $this-&gt;f_levels = $options;

        // We don't need toolbar in the modal window.
        if ($this-&gt;getLayout() !== 'modal')
        {
            $this-&gt;addToolbar();

            if (BIBLESTUDY_CHECKREL)
            {
                $this-&gt;sidebar = JHtmlSidebar::render();
            }
        }

        // Set the document
        $this-&gt;setDocument();

        // Display the template
        return parent::display($tpl);
    }

    /**
     * Add the page title and toolbar
     *
     * @return void
     *
     * @since 7.0
     */
    protected function addToolbar()
</codefragment>
  </duplication>
  <duplication lines="20" tokens="82">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/folders/tmpl/default.php" line="13"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/messages/tmpl/default.php" line="14"/>
    <codefragment>if (BIBLESTUDY_CHECKREL)
{
    JHtml::_('bootstrap.tooltip');
    JHtml::_('dropdown.init');
    JHtml::_('formbehavior.chosen', 'select');
}
else
{
    JHtml::_('behavior.tooltip');
}
JHtml::_('behavior.multiselect');

$app = JFactory::getApplication();
$user = JFactory::getUser();
$userId = $user-&gt;get('id');
$listOrder = $this-&gt;escape($this-&gt;state-&gt;get('list.ordering'));
$listDirn = $this-&gt;escape($this-&gt;state-&gt;get('list.direction'));
$archived = $this-&gt;state-&gt;get('filter.published') == 2 ? true : false;
$trashed = $this-&gt;state-&gt;get('filter.published') == -2 ? true : false;

</codefragment>
  </duplication>
  <duplication lines="47" tokens="85">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/folder/tmpl/edit.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/messagetype/tmpl/edit.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

// Load the tooltip behavior.
JHtml::_('behavior.tooltip');
JHtml::_('behavior.formvalidation');
JHtml::_('behavior.keepalive');
if (BIBLESTUDY_CHECKREL)
    JHtml::_('formbehavior.chosen', 'select');

// Create shortcut to parameters.
$params = $this-&gt;state-&gt;get('params');
$params = $params-&gt;toArray();
$app = JFactory::getApplication();
$input = $app-&gt;input;
?&gt;
&lt;script type="text/javascript"&gt;
    Joomla.submitbutton = function (task) {
        if (task == 'folder.cancel' || document.formvalidator.isValid(document.id('item-form'))) {
            Joomla.submitform(task, document.getElementById('item-form'));
        } else {
            alert('&lt;?php echo $this-&gt;escape(JText::_('JGLOBAL_VALIDATION_FORM_FAILED')); ?&gt;');
        }
    }
&lt;/script&gt;

&lt;form action="&lt;?php echo JRoute::_('index.php?option=com_biblestudy&amp;layout=edit&amp;id=' . (int) $this-&gt;item-&gt;id); ?&gt;"
      method="post" name="adminForm" id="item-form" class="form-validate"&gt;
    &lt;div class="row-fluid"&gt;
        &lt;!-- Begin Content --&gt;
        &lt;div class="span10 form-horizontal"&gt;
            &lt;ul class="nav nav-tabs"&gt;
                &lt;li class="active"&gt;&lt;a href="#general" data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_DETAILS'); ?&gt;&lt;/a&gt;
                &lt;/li&gt;

                &lt;?php if ($this-&gt;canDo-&gt;get('core.admin')): ?&gt;
                    &lt;li&gt;&lt;a href="#permissions" data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_FIELDSET_RULES'); ?&gt;&lt;/a&gt;
                    &lt;/li&gt;
                &lt;?php endif ?&gt;
            &lt;/ul&gt;
            &lt;div class="tab-content"&gt;
                &lt;!-- Begin Tabs --&gt;
                &lt;div class="tab-pane active" id="general"&gt;

                    &lt;div class="control-group"&gt;
                        &lt;div class="control-label"&gt;
                            &lt;?php echo $this-&gt;form-&gt;getLabel('id'); ?&gt;
                        &lt;/div&gt;
</codefragment>
  </duplication>
  <duplication lines="28" tokens="88">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/mediaimages/view.html.php" line="179"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/messagetypes/view.html.php" line="179"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/mimetypes/view.html.php" line="152"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/podcasts/view.html.php" line="145"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/templatecodes/view.html.php" line="188"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/templates/view.html.php" line="171"/>
    <codefragment>            JHtmlSidebar::addFilter(
                JText::_('JOPTION_SELECT_PUBLISHED'), 'filter_published',
                JHtml::_('select.options', JHtml::_('jgrid.publishedOptions'), 'value', 'text', $this-&gt;state-&gt;get('filter.published'), true)
            );

            JHtmlSidebar::addFilter(
                JText::_('JOPTION_SELECT_ACCESS'), 'filter_access',
                JHtml::_('select.options', JHtml::_('access.assetgroups'), 'value', 'text', $this-&gt;state-&gt;get('filter.access'))
            );

            JHtmlSidebar::addFilter(
                JText::_('JOPTION_SELECT_LANGUAGE'), 'filter_language',
                JHtml::_('select.options', JHtml::_('contentlanguage.existing', true, true), 'value', 'text', $this-&gt;state-&gt;get('filter.language'))
            );
        }
    }

    /**
     * Add the page title to browser.
     *
     * @return void
     *
     * @since    7.1.0
     */
    protected function setDocument()
    {
        $document = JFactory::getDocument();
        $document-&gt;setTitle(JText::_('JBS_TITLE_MEDIAIMAGES'));
</codefragment>
  </duplication>
  <duplication lines="32" tokens="85">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/migration.php" line="143"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/migration/view.html.php" line="102"/>
    <codefragment>    private function loadStack()
    {
        $session = JFactory::getSession();
        $stack   = $session-&gt;get('migration_stack', '', 'biblestudy');

        if (empty($stack))
        {
            $this-&gt;_versionStack = array();
            $this-&gt;_filesStack   = array();
            $this-&gt;_afterStack   = array();
            $this-&gt;totalVersions = 0;
            $this-&gt;doneVersions  = 0;

            return;
        }

        if (function_exists('base64_encode') &amp;&amp; function_exists('base64_decode'))
        {
            $stack = base64_decode($stack);

            if (function_exists('gzdeflate') &amp;&amp; function_exists('gzinflate'))
            {
                $stack = gzinflate($stack);
            }
        }
        $stack = json_decode($stack, true);

        $this-&gt;_versionStack = $stack['version'];
        $this-&gt;_filesStack   = $stack['files'];
        $this-&gt;_afterStack   = $stack['after'];
        $this-&gt;totalVersions = $stack['total'];
        $this-&gt;doneVersions  = $stack['done'];
</codefragment>
  </duplication>
  <duplication lines="50" tokens="85">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/folder/tmpl/edit.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/mimetype/tmpl/edit.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

// Load the tooltip behavior.
JHtml::_('behavior.tooltip');
JHtml::_('behavior.formvalidation');
JHtml::_('behavior.keepalive');
if (BIBLESTUDY_CHECKREL)
    JHtml::_('formbehavior.chosen', 'select');

// Create shortcut to parameters.
$params = $this-&gt;state-&gt;get('params');
$params = $params-&gt;toArray();
$app = JFactory::getApplication();
$input = $app-&gt;input;
?&gt;
&lt;script type="text/javascript"&gt;
    Joomla.submitbutton = function (task) {
        if (task == 'folder.cancel' || document.formvalidator.isValid(document.id('item-form'))) {
            Joomla.submitform(task, document.getElementById('item-form'));
        } else {
            alert('&lt;?php echo $this-&gt;escape(JText::_('JGLOBAL_VALIDATION_FORM_FAILED')); ?&gt;');
        }
    }
&lt;/script&gt;

&lt;form action="&lt;?php echo JRoute::_('index.php?option=com_biblestudy&amp;layout=edit&amp;id=' . (int) $this-&gt;item-&gt;id); ?&gt;"
      method="post" name="adminForm" id="item-form" class="form-validate"&gt;
    &lt;div class="row-fluid"&gt;
        &lt;!-- Begin Content --&gt;
        &lt;div class="span10 form-horizontal"&gt;
            &lt;ul class="nav nav-tabs"&gt;
                &lt;li class="active"&gt;&lt;a href="#general" data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_DETAILS'); ?&gt;&lt;/a&gt;
                &lt;/li&gt;

                &lt;?php if ($this-&gt;canDo-&gt;get('core.admin')): ?&gt;
                    &lt;li&gt;&lt;a href="#permissions" data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_FIELDSET_RULES'); ?&gt;&lt;/a&gt;
                    &lt;/li&gt;
                &lt;?php endif ?&gt;
            &lt;/ul&gt;
            &lt;div class="tab-content"&gt;
                &lt;!-- Begin Tabs --&gt;
                &lt;div class="tab-pane active" id="general"&gt;

                    &lt;div class="control-group"&gt;
                        &lt;div class="control-label"&gt;
                            &lt;?php echo $this-&gt;form-&gt;getLabel('id'); ?&gt;
                        &lt;/div&gt;
                        &lt;div class="controls"&gt;
                            &lt;?php echo $this-&gt;form-&gt;getInput('id'); ?&gt;
                        &lt;/div&gt;
</codefragment>
  </duplication>
  <duplication lines="37" tokens="81">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/folders/tmpl/default.php" line="169"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/mimetypes/tmpl/default.php" line="169"/>
    <codefragment>                                &lt;?php endif; ?&gt;
                            &lt;/div&gt;
                            &lt;div class="pull-left"&gt;
                                &lt;?php
                                if (BIBLESTUDY_CHECKREL)
                                {
                                    // Create dropdown items
                                    JHtml::_('dropdown.edit', $item-&gt;id, 'folder.');
                                    JHtml::_('dropdown.divider');
                                    if ($item-&gt;published) :
                                        JHtml::_('dropdown.unpublish', 'cb' . $i, 'folders.');
                                    else :
                                        JHtml::_('dropdown.publish', 'cb' . $i, 'folders.');
                                    endif;

                                    JHtml::_('dropdown.divider');

                                    if ($archived) :
                                        JHtml::_('dropdown.unarchive', 'cb' . $i, 'folders.');
                                    else :
                                        JHtml::_('dropdown.archive', 'cb' . $i, 'folders.');
                                    endif;

                                    if ($trashed) :
                                        JHtml::_('dropdown.untrash', 'cb' . $i, 'folders.');
                                    else :
                                        JHtml::_('dropdown.trash', 'cb' . $i, 'folders.');
                                    endif;

                                    // Render dropdown list
                                    echo JHtml::_('dropdown.render');
                                }
                                ?&gt;
                            &lt;/div&gt;
                        &lt;/td&gt;
                        &lt;td class="center hidden-phone"&gt;
                            &lt;?php echo (int) $item-&gt;id; ?&gt;
</codefragment>
  </duplication>
  <duplication lines="49" tokens="158">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/view.html.php" line="75"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/mimetypes/view.html.php" line="74"/>
    <codefragment>        if (count($errors = $this-&gt;get('Errors')))
        {
            JFactory::getApplication()-&gt;enqueueMessage(implode("\n", $errors), 'error');

            return false;
        }

        // Levels filter.
        $options   = array();
        $options[] = JHtml::_('select.option', '1', JText::_('J1'));
        $options[] = JHtml::_('select.option', '2', JText::_('J2'));
        $options[] = JHtml::_('select.option', '3', JText::_('J3'));
        $options[] = JHtml::_('select.option', '4', JText::_('J4'));
        $options[] = JHtml::_('select.option', '5', JText::_('J5'));
        $options[] = JHtml::_('select.option', '6', JText::_('J6'));
        $options[] = JHtml::_('select.option', '7', JText::_('J7'));
        $options[] = JHtml::_('select.option', '8', JText::_('J8'));
        $options[] = JHtml::_('select.option', '9', JText::_('J9'));
        $options[] = JHtml::_('select.option', '10', JText::_('J10'));

        $this-&gt;f_levels = $options;

        // We don't need toolbar in the modal window.
        if ($this-&gt;getLayout() !== 'modal')
        {
            $this-&gt;addToolbar();

            if (BIBLESTUDY_CHECKREL)
            {
                $this-&gt;sidebar = JHtmlSidebar::render();
            }
        }

        // Set the document
        $this-&gt;setDocument();

        // Display the template
        return parent::display($tpl);
    }

    /**
     * Add the page title and toolbar
     *
     * @return void
     *
     * @since 7.0
     */
    protected function addToolbar()
    {
</codefragment>
  </duplication>
  <duplication lines="15" tokens="107">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/view.html.php" line="83"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/podcasts/view.html.php" line="77"/>
    <codefragment>        $options   = array();
        $options[] = JHtml::_('select.option', '1', JText::_('J1'));
        $options[] = JHtml::_('select.option', '2', JText::_('J2'));
        $options[] = JHtml::_('select.option', '3', JText::_('J3'));
        $options[] = JHtml::_('select.option', '4', JText::_('J4'));
        $options[] = JHtml::_('select.option', '5', JText::_('J5'));
        $options[] = JHtml::_('select.option', '6', JText::_('J6'));
        $options[] = JHtml::_('select.option', '7', JText::_('J7'));
        $options[] = JHtml::_('select.option', '8', JText::_('J8'));
        $options[] = JHtml::_('select.option', '9', JText::_('J9'));
        $options[] = JHtml::_('select.option', '10', JText::_('J10'));

        $this-&gt;f_levels = $options;

        // We don't need toolbar in the modal window.
</codefragment>
  </duplication>
  <duplication lines="37" tokens="71">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comment/tmpl/edit.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/serie/tmpl/edit.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

// Include the component HTML helpers.
JHtml::addIncludePath(JPATH_COMPONENT . '/helpers/html');

// Load the tooltip behavior.
JHtml::_('behavior.tooltip');
JHtml::_('behavior.formvalidation');
JHtml::_('behavior.keepalive');
if (BIBLESTUDY_CHECKREL)
    JHtml::_('formbehavior.chosen', 'select');

// Create shortcut to parameters.
$params = $this-&gt;state-&gt;get('params');
$params = $params-&gt;toArray();

$app = JFactory::getApplication();
$input = $app-&gt;input;
?&gt;

&lt;script type="text/javascript"&gt;
    Joomla.submitbutton = function (task) {
        if (task == 'comment.cancel' || document.formvalidator.isValid(document.id('item-form'))) {
            Joomla.submitform(task, document.getElementById('item-form'));
        } else {
            alert('&lt;?php echo $this-&gt;escape(JText::_('JGLOBAL_VALIDATION_FORM_FAILED')); ?&gt;');
        }
    }
&lt;/script&gt;
&lt;form action="&lt;?php echo JRoute::_('index.php?option=com_biblestudy&amp;layout=edit&amp;id=' . (int) $this-&gt;item-&gt;id); ?&gt;"
      method="post" name="adminForm" id="item-form" class="form-validate"&gt;
    &lt;div class="row-fluid"&gt;
        &lt;!-- Begin Content --&gt;
        &lt;div class="span10 form-horizontal"&gt;
            &lt;fieldset&gt;
                &lt;ul class="nav nav-tabs"&gt;
                    &lt;li class="active"&gt;&lt;a href="#general"
</codefragment>
  </duplication>
  <duplication lines="22" tokens="86">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/folders/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/series/tmpl/default.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

if (BIBLESTUDY_CHECKREL)
{
    JHtml::_('bootstrap.tooltip');
    JHtml::_('dropdown.init');
    JHtml::_('formbehavior.chosen', 'select');
}
else
{
    JHtml::_('behavior.tooltip');
}
JHtml::_('behavior.multiselect');

$app = JFactory::getApplication();
$user = JFactory::getUser();
$userId = $user-&gt;get('id');
$listOrder = $this-&gt;escape($this-&gt;state-&gt;get('list.ordering'));
$listDirn = $this-&gt;escape($this-&gt;state-&gt;get('list.direction'));
$archived = $this-&gt;state-&gt;get('filter.published') == 2 ? true : false;
$trashed = $this-&gt;state-&gt;get('filter.published') == -2 ? true : false;

</codefragment>
  </duplication>
  <duplication lines="55" tokens="167">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/view.html.php" line="75"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/series/view.html.php" line="83"/>
    <codefragment>        if (count($errors = $this-&gt;get('Errors')))
        {
            JFactory::getApplication()-&gt;enqueueMessage(implode("\n", $errors), 'error');

            return false;
        }

        // Levels filter.
        $options   = array();
        $options[] = JHtml::_('select.option', '1', JText::_('J1'));
        $options[] = JHtml::_('select.option', '2', JText::_('J2'));
        $options[] = JHtml::_('select.option', '3', JText::_('J3'));
        $options[] = JHtml::_('select.option', '4', JText::_('J4'));
        $options[] = JHtml::_('select.option', '5', JText::_('J5'));
        $options[] = JHtml::_('select.option', '6', JText::_('J6'));
        $options[] = JHtml::_('select.option', '7', JText::_('J7'));
        $options[] = JHtml::_('select.option', '8', JText::_('J8'));
        $options[] = JHtml::_('select.option', '9', JText::_('J9'));
        $options[] = JHtml::_('select.option', '10', JText::_('J10'));

        $this-&gt;f_levels = $options;

        // We don't need toolbar in the modal window.
        if ($this-&gt;getLayout() !== 'modal')
        {
            $this-&gt;addToolbar();

            if (BIBLESTUDY_CHECKREL)
            {
                $this-&gt;sidebar = JHtmlSidebar::render();
            }
        }

        // Set the document
        $this-&gt;setDocument();

        // Display the template
        return parent::display($tpl);
    }

    /**
     * Add the page title and toolbar
     *
     * @return void
     *
     * @since 7.0
     */
    protected function addToolbar()
    {
        $user = JFactory::getUser();

        // Get the toolbar object instance
        $bar   = JToolBar::getInstance('toolbar');
        $canDo = JBSMBibleStudyHelper::getActions('', 'comment');
        JToolBarHelper::title(JText::_('JBS_CMN_COMMENTS'), 'comments.png');
</codefragment>
  </duplication>
  <duplication lines="32" tokens="94">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/podcasts/view.html.php" line="141"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/series/view.html.php" line="177"/>
    <codefragment>        if (BIBLESTUDY_CHECKREL)
        {
            JHtmlSidebar::setAction('index.php?option=com_biblestudy&amp;view=series');

            JHtmlSidebar::addFilter(
                JText::_('JOPTION_SELECT_PUBLISHED'), 'filter_published',
                JHtml::_('select.options', JHtml::_('jgrid.publishedOptions'), 'value', 'text', $this-&gt;state-&gt;get('filter.published'), true)
            );

            JHtmlSidebar::addFilter(
                JText::_('JOPTION_SELECT_ACCESS'), 'filter_access',
                JHtml::_('select.options', JHtml::_('access.assetgroups'), 'value', 'text', $this-&gt;state-&gt;get('filter.access'))
            );

            JHtmlSidebar::addFilter(
                JText::_('JOPTION_SELECT_LANGUAGE'), 'filter_language',
                JHtml::_('select.options', JHtml::_('contentlanguage.existing', true, true), 'value', 'text', $this-&gt;state-&gt;get('filter.language'))
            );
        }
    }

    /**
     * Add the page title to browser.
     *
     * @return void
     *
     * @since    7.1.0
     */
    protected function setDocument()
    {
        $document = JFactory::getDocument();
        $document-&gt;setTitle(JText::_('JBS_TITLE_PODCASTS'));
</codefragment>
  </duplication>
  <duplication lines="39" tokens="98">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/messages/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/servers/tmpl/default.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;
JHtml::addIncludePath(JPATH_COMPONENT . '/helpers/html');

if (BIBLESTUDY_CHECKREL)
{
    JHtml::_('bootstrap.tooltip');
    JHtml::_('dropdown.init');
    JHtml::_('formbehavior.chosen', 'select');
}
else
{
    JHtml::_('behavior.tooltip');
}
JHtml::_('behavior.multiselect');

$app = JFactory::getApplication();
$user = JFactory::getUser();
$userId = $user-&gt;get('id');
$listOrder = $this-&gt;escape($this-&gt;state-&gt;get('list.ordering'));
$listDirn = $this-&gt;escape($this-&gt;state-&gt;get('list.direction'));
$archived = $this-&gt;state-&gt;get('filter.published') == 2 ? true : false;
$trashed = $this-&gt;state-&gt;get('filter.published') == -2 ? true : false;
$saveOrder = $listOrder == 'study.ordering';

if ($saveOrder)
{
    $saveOrderingUrl = 'index.php?option=com_biblestudy&amp;task=message.saveOrderAjax&amp;tmpl=component';
    JHtml::_('sortablelist.sortable', 'articleList', 'adminForm', strtolower($listDirn), $saveOrderingUrl);
}

$sortFields = $this-&gt;getSortFields();
?&gt;
&lt;script type="text/javascript"&gt;
    Joomla.orderTable = function () {
        table = document.getElementById("sortTable");
        direction = document.getElementById("directionTable");
        order = table.options[table.selectedIndex].value;
        if (order != '&lt;?php echo $listOrder; ?&gt;') {
            dirn = 'asc';
</codefragment>
  </duplication>
  <duplication lines="46" tokens="85">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/folder/tmpl/edit.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/share/tmpl/edit.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/topic/tmpl/edit.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

// Load the tooltip behavior.
JHtml::_('behavior.tooltip');
JHtml::_('behavior.formvalidation');
JHtml::_('behavior.keepalive');
if (BIBLESTUDY_CHECKREL)
    JHtml::_('formbehavior.chosen', 'select');

// Create shortcut to parameters.
$params = $this-&gt;state-&gt;get('params');
$params = $params-&gt;toArray();
$app = JFactory::getApplication();
$input = $app-&gt;input;
?&gt;
&lt;script type="text/javascript"&gt;
    Joomla.submitbutton = function (task) {
        if (task == 'folder.cancel' || document.formvalidator.isValid(document.id('item-form'))) {
            Joomla.submitform(task, document.getElementById('item-form'));
        } else {
            alert('&lt;?php echo $this-&gt;escape(JText::_('JGLOBAL_VALIDATION_FORM_FAILED')); ?&gt;');
        }
    }
&lt;/script&gt;

&lt;form action="&lt;?php echo JRoute::_('index.php?option=com_biblestudy&amp;layout=edit&amp;id=' . (int) $this-&gt;item-&gt;id); ?&gt;"
      method="post" name="adminForm" id="item-form" class="form-validate"&gt;
    &lt;div class="row-fluid"&gt;
        &lt;!-- Begin Content --&gt;
        &lt;div class="span10 form-horizontal"&gt;
            &lt;ul class="nav nav-tabs"&gt;
                &lt;li class="active"&gt;&lt;a href="#general" data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_DETAILS'); ?&gt;&lt;/a&gt;
                &lt;/li&gt;

                &lt;?php if ($this-&gt;canDo-&gt;get('core.admin')): ?&gt;
                    &lt;li&gt;&lt;a href="#permissions" data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_FIELDSET_RULES'); ?&gt;&lt;/a&gt;
                    &lt;/li&gt;
                &lt;?php endif ?&gt;
            &lt;/ul&gt;
            &lt;div class="tab-content"&gt;
                &lt;!-- Begin Tabs --&gt;
                &lt;div class="tab-pane active" id="general"&gt;

                    &lt;div class="control-group"&gt;
                        &lt;div class="control-label"&gt;
                            &lt;?php echo $this-&gt;form-&gt;getLabel('id'); ?&gt;
</codefragment>
  </duplication>
  <duplication lines="42" tokens="138">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/view.html.php" line="83"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/shares/view.html.php" line="91"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/topics/view.html.php" line="93"/>
    <codefragment>        $options   = array();
        $options[] = JHtml::_('select.option', '1', JText::_('J1'));
        $options[] = JHtml::_('select.option', '2', JText::_('J2'));
        $options[] = JHtml::_('select.option', '3', JText::_('J3'));
        $options[] = JHtml::_('select.option', '4', JText::_('J4'));
        $options[] = JHtml::_('select.option', '5', JText::_('J5'));
        $options[] = JHtml::_('select.option', '6', JText::_('J6'));
        $options[] = JHtml::_('select.option', '7', JText::_('J7'));
        $options[] = JHtml::_('select.option', '8', JText::_('J8'));
        $options[] = JHtml::_('select.option', '9', JText::_('J9'));
        $options[] = JHtml::_('select.option', '10', JText::_('J10'));

        $this-&gt;f_levels = $options;

        // We don't need toolbar in the modal window.
        if ($this-&gt;getLayout() !== 'modal')
        {
            $this-&gt;addToolbar();

            if (BIBLESTUDY_CHECKREL)
            {
                $this-&gt;sidebar = JHtmlSidebar::render();
            }
        }

        // Set the document
        $this-&gt;setDocument();

        // Display the template
        return parent::display($tpl);
    }

    /**
     * Add the page title and toolbar
     *
     * @return void
     *
     * @since 7.0
     */
    protected function addToolbar()
    {
        $user = JFactory::getUser();
</codefragment>
  </duplication>
  <duplication lines="51" tokens="158">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/view.html.php" line="75"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/styles/view.html.php" line="73"/>
    <codefragment>        if (count($errors = $this-&gt;get('Errors')))
        {
            JFactory::getApplication()-&gt;enqueueMessage(implode("\n", $errors), 'error');

            return false;
        }

        // Levels filter.
        $options   = array();
        $options[] = JHtml::_('select.option', '1', JText::_('J1'));
        $options[] = JHtml::_('select.option', '2', JText::_('J2'));
        $options[] = JHtml::_('select.option', '3', JText::_('J3'));
        $options[] = JHtml::_('select.option', '4', JText::_('J4'));
        $options[] = JHtml::_('select.option', '5', JText::_('J5'));
        $options[] = JHtml::_('select.option', '6', JText::_('J6'));
        $options[] = JHtml::_('select.option', '7', JText::_('J7'));
        $options[] = JHtml::_('select.option', '8', JText::_('J8'));
        $options[] = JHtml::_('select.option', '9', JText::_('J9'));
        $options[] = JHtml::_('select.option', '10', JText::_('J10'));

        $this-&gt;f_levels = $options;

        // We don't need toolbar in the modal window.
        if ($this-&gt;getLayout() !== 'modal')
        {
            $this-&gt;addToolbar();

            if (BIBLESTUDY_CHECKREL)
            {
                $this-&gt;sidebar = JHtmlSidebar::render();
            }
        }

        // Set the document
        $this-&gt;setDocument();

        // Display the template
        return parent::display($tpl);
    }

    /**
     * Add the page title and toolbar
     *
     * @return void
     *
     * @since 7.0
     */
    protected function addToolbar()
    {
        $user = JFactory::getUser();

</codefragment>
  </duplication>
  <duplication lines="45" tokens="70">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/podcast/tmpl/edit.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/teacher/tmpl/edit.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

// Load the tooltip behavior.
JHtml::_('behavior.tooltip');
JHtml::_('behavior.formvalidation');
JHtml::_('behavior.keepalive');
if (BIBLESTUDY_CHECKREL)
    JHtml::_('formbehavior.chosen', 'select');

// Create shortcut to parameters.
$params = $this-&gt;state-&gt;get('params');
$params = $params-&gt;toArray();
$app    = JFactory::getApplication();
$input  = $app-&gt;input;
?&gt;
&lt;script type="text/javascript"&gt;
    Joomla.submitbutton = function (task) {
        if (task == 'podcast.cancel' || document.formvalidator.isValid(document.id('item-form'))) {
            Joomla.submitform(task, document.getElementById('item-form'));
        } else {
            alert('&lt;?php echo $this-&gt;escape(JText::_('JGLOBAL_VALIDATION_FORM_FAILED')); ?&gt;');
        }
    }
&lt;/script&gt;

&lt;form action="&lt;?php echo JRoute::_('index.php?option=com_biblestudy&amp;layout=edit&amp;id=' . (int) $this-&gt;item-&gt;id); ?&gt;"
      method="post" name="adminForm" id="item-form" class="form-validate"&gt;
&lt;div class="row-fluid"&gt;
&lt;!-- Begin Content --&gt;
&lt;div class="span10 form-horizontal"&gt;
    &lt;ul class="nav nav-tabs"&gt;
        &lt;li class="active"&gt;&lt;a href="#general" data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_DETAILS'); ?&gt;&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href="#images" data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_PDC_PODCAST_IMAGES'); ?&gt;&lt;/a&gt;&lt;/li&gt;

        &lt;?php if ($this-&gt;canDo-&gt;get('core.admin')): ?&gt;
        &lt;li&gt;&lt;a href="#permissions" data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_FIELDSET_RULES'); ?&gt;&lt;/a&gt;&lt;/li&gt;
        &lt;?php endif ?&gt;
    &lt;/ul&gt;
    &lt;div class="tab-content form-horizontal"&gt;
        &lt;!-- Begin Tabs --&gt;
        &lt;div class="tab-pane active" id="general"&gt;
            &lt;div class="control-group"&gt;
                &lt;div class="control-label"&gt;
                    &lt;?php echo $this-&gt;form-&gt;getLabel('title'); ?&gt;
                &lt;/div&gt;
</codefragment>
  </duplication>
  <duplication lines="44" tokens="85">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/folder/tmpl/edit.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/templatecode/tmpl/edit.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

// Load the tooltip behavior.
JHtml::_('behavior.tooltip');
JHtml::_('behavior.formvalidation');
JHtml::_('behavior.keepalive');
if (BIBLESTUDY_CHECKREL)
    JHtml::_('formbehavior.chosen', 'select');

// Create shortcut to parameters.
$params = $this-&gt;state-&gt;get('params');
$params = $params-&gt;toArray();
$app = JFactory::getApplication();
$input = $app-&gt;input;
?&gt;
&lt;script type="text/javascript"&gt;
    Joomla.submitbutton = function (task) {
        if (task == 'folder.cancel' || document.formvalidator.isValid(document.id('item-form'))) {
            Joomla.submitform(task, document.getElementById('item-form'));
        } else {
            alert('&lt;?php echo $this-&gt;escape(JText::_('JGLOBAL_VALIDATION_FORM_FAILED')); ?&gt;');
        }
    }
&lt;/script&gt;

&lt;form action="&lt;?php echo JRoute::_('index.php?option=com_biblestudy&amp;layout=edit&amp;id=' . (int) $this-&gt;item-&gt;id); ?&gt;"
      method="post" name="adminForm" id="item-form" class="form-validate"&gt;
    &lt;div class="row-fluid"&gt;
        &lt;!-- Begin Content --&gt;
        &lt;div class="span10 form-horizontal"&gt;
            &lt;ul class="nav nav-tabs"&gt;
                &lt;li class="active"&gt;&lt;a href="#general" data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_DETAILS'); ?&gt;&lt;/a&gt;
                &lt;/li&gt;

                &lt;?php if ($this-&gt;canDo-&gt;get('core.admin')): ?&gt;
                    &lt;li&gt;&lt;a href="#permissions" data-toggle="tab"&gt;&lt;?php echo JText::_('JBS_CMN_FIELDSET_RULES'); ?&gt;&lt;/a&gt;
                    &lt;/li&gt;
                &lt;?php endif ?&gt;
            &lt;/ul&gt;
            &lt;div class="tab-content"&gt;
                &lt;!-- Begin Tabs --&gt;
                &lt;div class="tab-pane active" id="general"&gt;

                    &lt;div class="control-group"&gt;
</codefragment>
  </duplication>
  <duplication lines="43" tokens="140">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/view.html.php" line="83"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/templatecodes/view.html.php" line="112"/>
    <codefragment>        $options   = array();
        $options[] = JHtml::_('select.option', '1', JText::_('J1'));
        $options[] = JHtml::_('select.option', '2', JText::_('J2'));
        $options[] = JHtml::_('select.option', '3', JText::_('J3'));
        $options[] = JHtml::_('select.option', '4', JText::_('J4'));
        $options[] = JHtml::_('select.option', '5', JText::_('J5'));
        $options[] = JHtml::_('select.option', '6', JText::_('J6'));
        $options[] = JHtml::_('select.option', '7', JText::_('J7'));
        $options[] = JHtml::_('select.option', '8', JText::_('J8'));
        $options[] = JHtml::_('select.option', '9', JText::_('J9'));
        $options[] = JHtml::_('select.option', '10', JText::_('J10'));

        $this-&gt;f_levels = $options;

        // We don't need toolbar in the modal window.
        if ($this-&gt;getLayout() !== 'modal')
        {
            $this-&gt;addToolbar();

            if (BIBLESTUDY_CHECKREL)
            {
                $this-&gt;sidebar = JHtmlSidebar::render();
            }
        }

        // Set the document
        $this-&gt;setDocument();

        // Display the template
        return parent::display($tpl);
    }

    /**
     * Add the page title and toolbar
     *
     * @return void
     *
     * @since 7.0
     */
    protected function addToolbar()
    {
        $user = JFactory::getUser();

</codefragment>
  </duplication>
  <duplication lines="22" tokens="123">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/view.html.php" line="83"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/templates/view.html.php" line="96"/>
    <codefragment>        $options   = array();
        $options[] = JHtml::_('select.option', '1', JText::_('J1'));
        $options[] = JHtml::_('select.option', '2', JText::_('J2'));
        $options[] = JHtml::_('select.option', '3', JText::_('J3'));
        $options[] = JHtml::_('select.option', '4', JText::_('J4'));
        $options[] = JHtml::_('select.option', '5', JText::_('J5'));
        $options[] = JHtml::_('select.option', '6', JText::_('J6'));
        $options[] = JHtml::_('select.option', '7', JText::_('J7'));
        $options[] = JHtml::_('select.option', '8', JText::_('J8'));
        $options[] = JHtml::_('select.option', '9', JText::_('J9'));
        $options[] = JHtml::_('select.option', '10', JText::_('J10'));

        $this-&gt;f_levels = $options;

        // We don't need toolbar in the modal window.
        if ($this-&gt;getLayout() !== 'modal')
        {
            $this-&gt;addToolbar();

            if (BIBLESTUDY_CHECKREL)
            {
                $this-&gt;sidebar = JHtmlSidebar::render();
</codefragment>
  </duplication>
  <duplication lines="854" tokens="1616">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/biblestudy.script.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/biblestudy.script.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;
jimport('joomla.filesystem.folder');
jimport('joomla.filesystem.file');
/**
 * BibleStudy Install Script
 *
 * @package  BibleStudy.Admin
 * @since    7.0.0
 */
class Com_BiblestudyInstallerScript
{

    /**
     * The release value to be displayed and check against throughout this file.
     *
     * @var string
     */
    private $_release = '8.0.2';

    /**
     * Find minimum required joomla version for this extension.
     * It will be read from the version attribute (install tag) in the manifest file
     *
     * @var string
     */
    private $_minimum_joomla_release = '2.5.6';

    /**
     * Find minimum required PHP version for this extension.
     * It will be read from the version attribute (install tag) in the manifest file
     *
     * @var string
     */
    private $_minimum_php = '5.3.1';

    /**
     * The component's name
     *
     * @var string
     * */
    protected $biblestudy_extension = 'com_biblestudy';

    /**
     * $parent is the class calling this method.
     * $type is the type of change (install, update or discover_install, not uninstall).
     * preflight runs before anything else and while the extracted files are in the uploaded temp folder.
     * If preflight returns false, Joomla will abort the update and undo everything already done.
     *
     * @param   string          $type    Type of install
     * @param   JInstallerFile  $parent  Where it is coming from
     *
     * @return boolean
     */
    public function preflight($type, $parent)
    {
        // This component does not work with Joomla releases prior to 2.5
        // abort if the current Joomla release is older

        // Extract the version number from the manifest. This will overwrite the 1.0 value set above
        /** @noinspection PhpUndefinedMethodInspection */
        $this-&gt;_release = $parent-&gt;get("manifest")-&gt;version;

        // Start DB factory
        $db = JFactory::getDBO();

        // Set the #__schemas version_id to the correct number so the update will occur if out of sequence.
        $query = $db-&gt;getQuery(true);
        $query-&gt;select('extension_id')
            -&gt;from('#__extensions')
            -&gt;where('name LIKE ' . $db-&gt;q('%com_biblestudy%'));
        $db-&gt;setQuery($query);
        $extensionid = $db-&gt;loadResult();

        if ($extensionid)
        {
            $query = $db-&gt;getQuery(true);
            $query-&gt;select('version_id')
                -&gt;from('#__schemas')
                -&gt;where('extension_id = ' . $db-&gt;quote($extensionid));
            $db-&gt;setQuery($query);
            $jbsversion = $db-&gt;loadResult();

            if ($jbsversion == '20100101')
            {
                $query = $db-&gt;getQuery(true);
                $query-&gt;update('#__schemas')
                    -&gt;set('version_id = ' . $db-&gt;q('7.0.0'))
                    -&gt;where('extension_id = ' . $db-&gt;quote($extensionid));
                $db-&gt;setQuery($query);
                $db-&gt;execute();
            }
        }

        if ($type == 'install')
        {
            // Copy the css file over to another location
            $src = JPATH_SITE . '/components/com_biblestudy/assets/css/biblestudy.css';

            if (JFile::exists($src))
            {
                JFile::copy($src, JPATH_SITE . '/tmp/biblestudy.css');
            }
        }
        $install_good = version_compare(PHP_VERSION, $this-&gt;_minimum_php, '&lt;');

        if (!$install_good)
        {
            $install_good = version_compare(JVERSION, $this-&gt;_minimum_joomla_release, 'ge');
        }
        else
        {
            JFactory::$application-&gt;enqueueMessage('Your host needs to use PHP ' . $this-&gt;_minimum_php . ' or higher to run Joomla Bible Study');
            $install_good = false;
        }

        // Only allow to install on minimum Joomla! version
        return $install_good;
    }

    /**
     * Install
     *
     * @param   JInstallerFile  $parent  Where call is coming from
     *
     * @return  void
     */
    public function install($parent)
    {
        $db     = JFactory::getDBO();
        $buffer = file_get_contents(JPATH_ADMINISTRATOR . '/components/com_biblestudy/install/sql/install-defaults.sql');

        if ($buffer === false)
        {
            die('No install-defaults.sql file');
        }

        // Create an array of queries from the sql file
        $queries = $db-&gt;splitSql($buffer);

        foreach ($queries as $querie)
        {
            $querie = trim($querie);

            if ($querie != '' &amp;&amp; $querie{0} != '#')
            {
                $db-&gt;setQuery($querie);
                $db-&gt;execute();
            }
        }
        require_once JPATH_ADMINISTRATOR . '/components/com_biblestudy/install/biblestudy.install.special.php';
        $fresh = new JBSMFreshInstall;

        if (!$fresh-&gt;installCSS())
        {
            JFactory::getApplication()-&gt;enqueueMessage(JText::_('JBS_INS_FAILURE'), 'error');
        }

    }

    /**
     * Uninstall
     *
     * @param   JInstallerFile  $parent  Where call is coming from
     *
     * @return   void
     */
    public function uninstall($parent)
    {
        $dbhelper    = new JBSMDbHelper;
        $drop_result = '';

        if ($dbhelper-&gt;checkIfTable('#__bsms_admin'))
        {
            $db    = JFactory::getDBO();
            $query = $db-&gt;getQuery(true);
            $query-&gt;select('*')
                -&gt;from('#__bsms_admin')
                -&gt;where('id = 1');
            $db-&gt;setQuery($query);
            $adminsettings = $db-&gt;loadObject();

            $drop_tables = $adminsettings-&gt;drop_tables;

            if ($drop_tables &gt; 0)
            {
                // We must remove the assets manually each time
                $db    = JFactory::getDBO();
                $query = $db-&gt;getQuery(true);
                $query-&gt;select('id')
                    -&gt;from('#__assets')
                    -&gt;where('name = ' . $db-&gt;q($this-&gt;biblestudy_extension));
                $db-&gt;setQuery($query);
                $parent_id = $db-&gt;loadResult();
                $query     = $db-&gt;getQuery(true);

                if ($parent_id != '0')
                {
                    $query-&gt;delete()
                        -&gt;from('#__assets')
                        -&gt;where('parent_id = ' . $db-&gt;q($parent_id))
                        -&gt;where('name != ' . $db-&gt;q('root.1'));
                    $db-&gt;setQuery($query);
                    $db-&gt;execute();
                }

                $query = $db-&gt;getQuery(true);
                $query-&gt;delete()
                    -&gt;from('#__assets')
                    -&gt;where('name LIKE ' . $db-&gt;q($this-&gt;biblestudy_extension))
                    -&gt;where('name != ' . $db-&gt;q('root.1'));
                $db-&gt;setQuery($query);
                $db-&gt;execute();
                $buffer = file_get_contents(JPATH_ADMINISTRATOR . '/components/com_biblestudy/install/sql/uninstall-dbtables.sql');

                // Graceful exit and rollback if read not successful
                if ($buffer === false)
                {
                    die('no uninstall-dbtables.sql');
                }
                $queries = $db-&gt;splitSql($buffer);

                foreach ($queries as $querie)
                {
                    $querie = trim($querie);

                    if ($querie != '' &amp;&amp; $querie{0} != '#' &amp;&amp; $querie != '`')
                    {
                        $db-&gt;setQuery($querie);
                        $db-&gt;execute();
                    }
                }
            }
        }
        else
        {
            $drop_result = '&lt;h3&gt;' . JText::_('JBS_INS_NO_DATABASE_REMOVED') . '&lt;/h3&gt;';
        }
        echo '&lt;h2&gt;' . JText::_('JBS_INS_UNINSTALLED') . ' ' . $this-&gt;_release . '&lt;/h2&gt; &lt;div&gt;' . $drop_result . '&lt;/div&gt;';
    }

    /**
     * Update
     *
     * @param   JInstallerFile  $parent  Where call is coming from
     *
     * @return   void
     */
    public function update($parent)
    {
        $this-&gt;fixMenus();
        $this-&gt;fixImagePaths();
        $this-&gt;fixemptyaccess();
        $this-&gt;fixemptylanguage();
        JLoader::register('JBS800Update', JPATH_ADMINISTRATOR . '/components/com_biblestudy/install/updates/8.0.0.php');
        $update800 = new JBS800Update;
        $update800-&gt;update800();
    }

    /**
     * Post Flight
     *
     * @param   string          $type    Type of install
     * @param   JInstallerFile  $parent  Where it is coming from
     *
     * @return   void
     */
    public function postflight($type, $parent)
    {
        // Set the #__schemas version_id to the correct number for error from 7.0.0
        $db    = JFactory::getDBO();
        $query = $db-&gt;getQuery(true);
        $query-&gt;select('extension_id')
            -&gt;from('#__extensions')
            -&gt;where('name LIKE' . $db-&gt;q('%com_biblestudy%'));
        $db-&gt;setQuery($query);
        $extensionid = $db-&gt;loadResult();

        if ($extensionid)
        {
            $query = $db-&gt;getQuery(true);
            $query-&gt;select('version_id')
                -&gt;from('#__schemas')
                -&gt;where('extension_id = ' . $db-&gt;q($extensionid));
            $db-&gt;setQuery($query);
            $jbsversion = $db-&gt;loadResult();

            if ($jbsversion == '20100101')
            {
                $query = $db-&gt;getQuery(true);
                $query-&gt;update('#__schemas')
                    -&gt;set('version_id = ' . $db-&gt;q($this-&gt;_release))
                    -&gt;where('extension_id = ' . $db-&gt;q($extensionid));
                $db-&gt;setQuery($query);
                $db-&gt;execute();
            }
        }

        // Set initial values for component parameters
        $params['my_param0'] = 'Component version ' . $this-&gt;_release;
        $params['my_param1'] = 'Start';
        $params['my_param2'] = '1';
        $this-&gt;setParams($params);

        // Set install state
        $subquery = '{"release":"' . $this-&gt;_release . '","jbsparent":"' .
            $parent . '","jbstype":"' . $type . '","jbsname":"com_biblestudy"}';
        $query1   = $db-&gt;getQuery(true);
        $query1-&gt;update('#__bsms_admin')
            -&gt;set('installstate = ' . $db-&gt;q($subquery))
            -&gt;where('id = 1');
        $db-&gt;setQuery($query1);
        $db-&gt;execute();

        // An redirect to a new location after the install is completed.
        $parent-&gt;getParent()-&gt;set('redirect_url', JURI::base() . 'index.php?option=com_biblestudy');
    }

    /**
     * Get a variable from the manifest file (actually, from the manifest cache).
     *
     * @param   string  $name  Name of param
     *
     * @return string
     */
    public function getParam($name)
    {
        $db    = JFactory::getDbo();
        $query = $db-&gt;getQuery(true);
        $query-&gt;select('manifest_cache')
            -&gt;from('#_extensions')
            -&gt;where('name = ' . $db-&gt;q($this-&gt;biblestudy_extension));
        $db-&gt;setQuery($query);
        $manifest = json_decode($db-&gt;loadResult(), true);

        return $manifest[$name];
    }

    /**
     * sets parameter values in the component's row of the extension table
     *
     * @param   array  $param_array  Array of params to set.
     *
     * @return   void
     */
    public function setParams($param_array)
    {
        if (count($param_array) &gt; 0)
        {
            // Read the existing component value(s)
            $db    = JFactory::getDbo();
            $query = $db-&gt;getQuery(true);
            $query-&gt;select('params')
                -&gt;from('#__extensions')
                -&gt;where('name = ' . $db-&gt;q($this-&gt;biblestudy_extension));
            $db-&gt;setQuery($query);
            $params = json_decode($db-&gt;loadResult(), true);

            // Add the new variable(s) to the existing one(s)
            foreach ($param_array as $name =&gt; $value)
            {
                $params[(string) $name] = (string) $value;
            }

            // Store the combined new and existing values back as a JSON string
            $paramsString = json_encode($params);
            $query        = $db-&gt;getQuery(true);
            $query-&gt;update('#__extensions')
                -&gt;set('params = ' . $db-&gt;q($paramsString))
                -&gt;where('name = ' . $db-&gt;q($this-&gt;biblestudy_extension));
            $db-&gt;setQuery($query);
            $db-&gt;execute();
        }
    }

    /**
     * Remove Old Files and Folders
     *
     * @since 7.1.0
     *
     * @return   void
     */
    public function deleteUnexistingFiles()
    {
        $files = array(
            '/media/com_biblestudy/css/biblestudy.css.dist',
            '/images/textfile24.png',
            '/components/com_biblestudy/biblestudy.css',
            '/components/com_biblestudy/class.biblestudydownload.php',
            '/components/language/en-GB/en-GB.com_biblestudy.ini',
            '/administrator/language/en-GB/en-GB.com_biblestudy.ini',
            '/administrator/language/en-GB/en-GB.com_biblestudy.sys.ini',
            '/administrator/components/com_biblestudy/Snoopy.class.php',
            '/administrator/components/com_biblestudy/admin.biblestudy.php',
            '/components/com_biblestudy/helpers/updatesef.php',
            '/components/com_biblestudy/helpers/image.php',
            '/components/com_biblestudy/helpers/helper.php',
            '/components/com_biblestudy/views/messages/tmpl/modal16.php',
            '/components/com_biblestudy/controllers/teacherlist.php',
            '/components/com_biblestudy/controllers/teacherdisplay.php',
            '/components/com_biblestudy/controllers/studydetails.php',
            '/components/com_biblestudy/controllers/studieslist.php',
            '/components/com_biblestudy/controllers/serieslist.php',
            '/components/com_biblestudy/controllers/seriesdetail.php',
            '/components/com_biblestudy/models/teacherlist.php',
            '/components/com_biblestudy/models/teacherdisplay.php',
            '/components/com_biblestudy/models/studydetails.php',
            '/components/com_biblestudy/models/studieslist.php',
            '/components/com_biblestudy/models/seriesdetail.php',
            '/components/com_biblestudy/models/serieslist.php',
            '/components/com_biblestudy/views/mediafile/tmpl/form.php',
            '/components/com_biblestudy/views/mediafile/tmpl/form.xml',
            '/language/en-GB/en-GB.com_biblestudy.ini',
            '/language/cs-CZ/cs-CZ.com_biblestudy.ini',
            '/language/de-DE/de-DE.com_biblestudy.ini',
            '/language/es-ES/es-ES.com_biblestudy.ini',
            '/language/hu-HU/hu-HU.com_biblestudy.ini',
            '/language/nl-NL/nl-NL.com_biblestudy.ini',
            '/language/no-NO/no-NO.com_biblestudy.ini',
            '/language/en-GB/en-GB.mod_biblestudy.ini',
            '/language/en-GB/en-GB.mod_biblestudy.sys.ini',
            '/administrator/components/com_biblestudy/install/biblestudy.assets.php',
            '/administrator/components/com_biblestudy/install/sql/jbs7.0.0.sql',
            '/administrator/components/com_biblestudy/install/sql/updates/mysql/20100101.sql',
            '/administrator/components/com_biblestudy/lib/biblestudy.podcast.class.php',
            '/administrator/components/com_biblestudy/controllers/commentsedit.php',
            '/administrator/components/com_biblestudy/controllers/commentslist.php',
            '/administrator/components/com_biblestudy/controllers/cssedit.php',
            '/administrator/components/com_biblestudy/controllers/folderslist.php',
            '/administrator/components/com_biblestudy/controllers/foldersedit.php',
            '/administrator/components/com_biblestudy/controllers/locationslist.php',
            '/administrator/components/com_biblestudy/controllers/locationsedit.php',
            '/administrator/components/com_biblestudy/controllers/mediaedit.php',
            '/administrator/components/com_biblestudy/controllers/mediafilesedit.php',
            '/administrator/components/com_biblestudy/controllers/mediafileslist.php',
            '/administrator/components/com_biblestudy/controllers/medialist.php',
            '/administrator/components/com_biblestudy/controllers/messagetypelist.php',
            '/administrator/components/com_biblestudy/controllers/messagetypeedit.php',
            '/administrator/components/com_biblestudy/controllers/mimetypelist.php',
            '/administrator/components/com_biblestudy/controllers/mimetypeedit.php',
            '/administrator/components/com_biblestudy/controllers/podcastlist.php',
            '/administrator/components/com_biblestudy/controllers/podcastedit.php',
            '/administrator/components/com_biblestudy/controllers/serieslist.php',
            '/administrator/components/com_biblestudy/controllers/seriesedit.php',
            '/administrator/components/com_biblestudy/controllers/serverslist.php',
            '/administrator/components/com_biblestudy/controllers/serversedit.php',
            '/administrator/components/com_biblestudy/controllers/sharelist.php',
            '/administrator/components/com_biblestudy/controllers/shareedit.php',
            '/administrator/components/com_biblestudy/controllers/studieslist.php',
            '/administrator/components/com_biblestudy/controllers/studiesedit.php',
            '/administrator/components/com_biblestudy/controllers/teacherlist.php',
            '/administrator/components/com_biblestudy/controllers/teacheredit.php',
            '/administrator/components/com_biblestudy/controllers/templateedit.php',
            '/administrator/components/com_biblestudy/controllers/templateslist.php',
            '/administrator/components/com_biblestudy/controllers/topicslist.php',
            '/administrator/components/com_biblestudy/controllers/topicsedit.php',
            '/administrator/components/com_biblestudy/models/forms/commentsedit.xml',
            '/administrator/components/com_biblestudy/models/forms/foldersedit.xml',
            '/administrator/components/com_biblestudy/models/forms/locationsedit.xml',
            '/administrator/components/com_biblestudy/models/forms/mediaedit.xml',
            '/administrator/components/com_biblestudy/models/forms/mediafilesedit.xml',
            '/administrator/components/com_biblestudy/models/forms/messagetypeedit.xml',
            '/administrator/components/com_biblestudy/models/forms/mimetypeedit.xml',
            '/administrator/components/com_biblestudy/models/forms/podcastedit.xml',
            '/administrator/components/com_biblestudy/models/forms/seriesedit.xml',
            '/administrator/components/com_biblestudy/models/forms/serversedit.xml',
            '/administrator/components/com_biblestudy/models/forms/shareedit.xml',
            '/administrator/components/com_biblestudy/models/forms/studiesedit.xml',
            '/administrator/components/com_biblestudy/models/forms/teacheredit.xml',
            '/administrator/components/com_biblestudy/models/forms/templateedit.xml',
            '/administrator/components/com_biblestudy/models/forms/topicsedit.xml',
            '/administrator/components/com_biblestudy/models/episodelist.php',
            '/administrator/components/com_biblestudy/models/commentsedit.php',
            '/administrator/components/com_biblestudy/models/commentslist.php',
            '/administrator/components/com_biblestudy/models/cssedit.php',
            '/administrator/components/com_biblestudy/models/folderslist.php',
            '/administrator/components/com_biblestudy/models/foldersedit.php',
            '/administrator/components/com_biblestudy/models/locationslist.php',
            '/administrator/components/com_biblestudy/models/locationsedit.php',
            '/administrator/components/com_biblestudy/models/mediaedit.php',
            '/administrator/components/com_biblestudy/models/mediafilesedit.php',
            '/administrator/components/com_biblestudy/models/mediafileslist.php',
            '/administrator/components/com_biblestudy/models/medialist.php',
            '/administrator/components/com_biblestudy/models/messagetypelist.php',
            '/administrator/components/com_biblestudy/models/messagetypeedit.php',
            '/administrator/components/com_biblestudy/models/mimetypelist.php',
            '/administrator/components/com_biblestudy/models/mimetypeedit.php',
            '/administrator/components/com_biblestudy/models/podcastlist.php',
            '/administrator/components/com_biblestudy/models/podcastedit.php',
            '/administrator/components/com_biblestudy/models/serieslist.php',
            '/administrator/components/com_biblestudy/models/seriesedit.php',
            '/administrator/components/com_biblestudy/models/serverslist.php',
            '/administrator/components/com_biblestudy/models/serversedit.php',
            '/administrator/components/com_biblestudy/models/sharelist.php',
            '/administrator/components/com_biblestudy/models/shareedit.php',
            '/administrator/components/com_biblestudy/models/studieslist.php',
            '/administrator/components/com_biblestudy/models/studiesedit.php',
            '/administrator/components/com_biblestudy/models/teacherlist.php',
            '/administrator/components/com_biblestudy/models/teacheredit.php',
            '/administrator/components/com_biblestudy/models/templateedit.php',
            '/administrator/components/com_biblestudy/models/templateslist.php',
            '/administrator/components/com_biblestudy/models/topicslist.php',
            '/administrator/components/com_biblestudy/models/topicsedit.php',
            '/administrator/components/com_biblestudy/tables/biblestudy.php',
            '/administrator/components/com_biblestudy/tables/booksedit.php',
            '/administrator/components/com_biblestudy/tables/commentsedit.php',
            '/administrator/components/com_biblestudy/tables/foldersedit.php',
            '/administrator/components/com_biblestudy/tables/locationsedit.php',
            '/administrator/components/com_biblestudy/tables/mediaedit.php',
            '/administrator/components/com_biblestudy/tables/mediafilesedit.php',
            '/administrator/components/com_biblestudy/tables/messagetypeedit.php',
            '/administrator/components/com_biblestudy/tables/mimetypeedit.php',
            '/administrator/components/com_biblestudy/tables/podcastedit.php',
            '/administrator/components/com_biblestudy/tables/seriesedit.php',
            '/administrator/components/com_biblestudy/tables/serversedit.php',
            '/administrator/components/com_biblestudy/tables/shareedit.php',
            '/administrator/components/com_biblestudy/tables/studiesedit.php',
            '/administrator/components/com_biblestudy/tables/teacheredit.php',
            '/administrator/components/com_biblestudy/tables/topicsedit.php',
            '/administrator/components/com_biblestudy/tables/templateedit.php',
            '/administrator/components/com_biblestudy/helpers/version.php',
            '/administrator/language/en-GB/en-GB.com_biblestudy.ini',
            '/administrator/language/en-GB/en-GB.com_biblestudy.sys.ini',
            '/administrator/language/cs-CZ/cs-CZ.com_biblestudy.ini',
            '/administrator/language/cs-CZ/cs-CZ.com_biblestudy.sys.ini',
            '/administrator/language/de-DE/de-DE.com_biblestudy.ini',
            '/administrator/language/de-DE/de-DE.com_biblestudy.sys.ini',
            '/administrator/language/es-ES/es-ES.com_biblestudy.ini',
            '/administrator/language/es-ES/es-ES.com_biblestudy.sys.ini',
            '/administrator/language/hu-HU/hu-HU.com_biblestudy.ini',
            '/administrator/language/hu-HU/hu-HU.com_biblestudy.sys.ini',
            '/administrator/language/nl-NL/nl-NL.com_biblestudy.ini',
            '/administrator/language/nl-NL/no-NO.com_biblestudy.ini',
            '/administrator/language/no-NO/no-NO.com_biblestudy.sys.ini',
            // JBSM 8.0.0
            // Site:
            '/components/com_biblestudy/controllers\commentsedit.php',
            '/components/com_biblestudy/controllers\commentslist.php',
            '/components/com_biblestudy/controllers\mediafile.php',
            '/components/com_biblestudy/controllers\mediafiles.php',
            '/components/com_biblestudy/controllers\message.php',
            '/components/com_biblestudy/controllers\messages.php',
            '/components/com_biblestudy/helpers\book.php',
            '/components/com_biblestudy/helpers\date.php',
            '/components/com_biblestudy/helpers\duration.php',
            '/components/com_biblestudy/helpers\editlink.php',
            '/components/com_biblestudy/helpers\editlisting.php',
            '/components/com_biblestudy/helpers\filepath.php',
            '/components/com_biblestudy/helpers\filesize.php',
            '/components/com_biblestudy/helpers\header.php',
            '/components/com_biblestudy/helpers\listing.php',
            '/components/com_biblestudy/helpers\location.php',
            '/components/com_biblestudy/helpers\mediatable.php',
            '/components/com_biblestudy/helpers\messagetype.php',
            '/components/com_biblestudy/helpers\params.php',
            '/components/com_biblestudy/helpers\passage.php',
            '/components/com_biblestudy/helpers\scripture.php',
            '/components/com_biblestudy/helpers\share.php',
            '/components/com_biblestudy/helpers\store.php',
            '/components/com_biblestudy/helpers\textlink.php',
            '/components/com_biblestudy/helpers\title.php',
            '/components/com_biblestudy/helpers\toolbar.php',
            '/components/com_biblestudy/helpers\topics.php',
            '/components/com_biblestudy/helpers\year.php',
            '/components/com_biblestudy/lib\biblestudy.admin.class.php',
            '/components/com_biblestudy/lib\biblestudy.defines.php',
            '/components/com_biblestudy/lib\biblestudy.stats.class.php',
            '/components/com_biblestudy/models\forms\commentsedit.xml',
            '/components/com_biblestudy/models\commentsedit.php',
            '/components/com_biblestudy/models\commentslist.php',
            '/components/com_biblestudy/models\mediafile.php',
            '/components/com_biblestudy/models\mediafiles.php',
            '/components/com_biblestudy/models\message.php',
            '/components/com_biblestudy/models\messages.php',
            // Admin:
            '/administrator/components/com_biblestudy/controllers\ajax.php',
            '/administrator/components/com_biblestudy/helpers\cleanurl.php',
            '/administrator/components/com_biblestudy/helpers\toolbar.php',
            '/administrator/components/com_biblestudy/lib\biblestudy.admin.class.php',
            '/administrator/components/com_biblestudy/lib\biblestudy.migrate.php',
            '/administrator/components/com_biblestudy/migration\biblestudy.611.upgrade.php',
            '/administrator/components/com_biblestudy/migration\biblestudy.612.upgrade.php',
            '/administrator/components/com_biblestudy/migration\biblestudy.613.upgrade.php',
            '/administrator/components/com_biblestudy/migration\biblestudy.614.upgrade.php',
            '/administrator/components/com_biblestudy/migration\biblestudy.622.upgrade.php',
            '/administrator/components/com_biblestudy/migration\biblestudy.623.upgrade.php',
            '/administrator/components/com_biblestudy/migration\biblestudy.700.upgrade.php',
            '/administrator/components/com_biblestudy/migration\update701.php',
            '/administrator/components/com_biblestudy/models\fields\locationordering.php',
            '/administrator/components/com_biblestudy/models\fields\mediaordering.php',
            '/administrator/components/com_biblestudy/models\fields\messagetypeordering.php',
            '/administrator/components/com_biblestudy/models\fields\shareordering.php',
            '/administrator/components/com_biblestudy/models\fields\teacherordering.php',
            '/administrator/components/com_biblestudy/views\admin\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\admin\tmpl\form_assets.php',
            '/administrator/components/com_biblestudy/views\admin\tmpl\form_backup.php',
            '/administrator/components/com_biblestudy/views\admin\tmpl\form_database.php',
            '/administrator/components/com_biblestudy/views\admin\tmpl\form_migrate.php',
            '/administrator/components/com_biblestudy/views\comment\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\folder\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\folders\tmpl\index.html',
            '/administrator/components/com_biblestudy/views\location\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\mediaimage\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\message\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\messagetype\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\mimetype\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\podcast\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\serie\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\server\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\server\tmpl\index.html',
            '/administrator/components/com_biblestudy/views\share\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\teacher\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\template\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\templatecode\tmpl\form.php',
            '/administrator/components/com_biblestudy/views\topic\tmpl\form.php',
        );

        $folders = array(
            '/components/com_biblestudy/assets',
            '/components/com_biblestudy/images',
            '/components/com_biblestudy/views/teacherlist',
            '/components/com_biblestudy/views/teacherdisplay',
            '/components/com_biblestudy/views/studieslist',
            '/components/com_biblestudy/views/studydetails',
            '/components/com_biblestudy/views/serieslist',
            '/components/com_biblestudy/views/seriesdetail',
            '/administrator/media',
            '/administrator/components/com_biblestudy/assets',
            '/administrator/components/com_biblestudy/images',
            '/administrator/components/com_biblestudy/css',
            '/administrator/components/com_biblestudy/js',
            '/administrator/components/com_biblestudy/views/commentsedit',
            '/administrator/components/com_biblestudy/views/commentslist',
            '/administrator/components/com_biblestudy/views/cssedit',
            '/administrator/components/com_biblestudy/views/folderslist',
            '/administrator/components/com_biblestudy/views/foldersedit',
            '/administrator/components/com_biblestudy/views/locationslist',
            '/administrator/components/com_biblestudy/views/locationsedit',
            '/administrator/components/com_biblestudy/views/mediaedit',
            '/administrator/components/com_biblestudy/views/mediafilesedit',
            '/administrator/components/com_biblestudy/views/mediafileslist',
            '/administrator/components/com_biblestudy/views/medialist',
            '/administrator/components/com_biblestudy/views/messagetypelist',
            '/administrator/components/com_biblestudy/views/messagetypeedit',
            '/administrator/components/com_biblestudy/views/mimetypelist',
            '/administrator/components/com_biblestudy/views/mimetypeedit',
            '/administrator/components/com_biblestudy/views/podcastlist',
            '/administrator/components/com_biblestudy/views/podcastedit',
            '/administrator/components/com_biblestudy/views/serieslist',
            '/administrator/components/com_biblestudy/views/seriesedit',
            '/administrator/components/com_biblestudy/views/serverslist',
            '/administrator/components/com_biblestudy/views/serversedit',
            '/administrator/components/com_biblestudy/views/sharelist',
            '/administrator/components/com_biblestudy/views/shareedit',
            '/administrator/components/com_biblestudy/views/studieslist',
            '/administrator/components/com_biblestudy/views/studiesedit',
            '/administrator/components/com_biblestudy/views/teacherlist',
            '/administrator/components/com_biblestudy/views/teacheredit',
            '/administrator/components/com_biblestudy/views/templateedit',
            '/administrator/components/com_biblestudy/views/templateslist',
            '/administrator/components/com_biblestudy/views/topicslist',
            '/administrator/components/com_biblestudy/views/topicsedit',
            // JBSM 8.0.0
            '/components/com_biblestudy/views/messages',
            '/components/com_biblestudy/views/message',
            '/components/com_biblestudy/views/mediafiles',
            '/components/com_biblestudy/views/mediafile',
            '/components/com_biblestudy/views/commentslist',
            '/components/com_biblestudy/views/commentsedit',
        );

        foreach ($files as $file)
        {
            if (JFile::exists(JPATH_ROOT . $file) &amp;&amp; !JFile::delete(JPATH_ROOT . $file))
            {
                echo JText::sprintf('FILES_JOOMLA_ERROR_FILE_FOLDER', $file) . '&lt;br /&gt;';
            }
        }

        foreach ($folders as $folder)
        {
            if (JFolder::exists(JPATH_ROOT . $folder) &amp;&amp; !JFolder::delete(JPATH_ROOT . $folder))
            {
                echo JText::sprintf('FILES_JOOMLA_ERROR_FILE_FOLDER', $folder) . '&lt;br /&gt;';
            }
        }
    }

    /**
     * Fix Menus
     *
     * @since 7.1.0
     *
     * @return   void
     */
    public function fixMenus()
    {
        $db    = JFactory::getDBO();
        $query = $db-&gt;getQuery(true);
        $query-&gt;select('*')
            -&gt;from('#__menu')
            -&gt;where($db-&gt;qn('menutype') . ' != ' . $db-&gt;q('main'))
            -&gt;where($db-&gt;qn('link') . ' LIKE ' . $db-&gt;q('%com_biblestudy%'));
        $db-&gt;setQuery($query);
        $menus = $db-&gt;loadObjectList();

        foreach ($menus AS $menu)
        {
            $menu-&gt;link = str_replace('teacherlist', 'teachers', $menu-&gt;link);
            $menu-&gt;link = str_replace('teacherdisplay', 'teacher', $menu-&gt;link);
            $menu-&gt;link = str_replace('studydetails', 'sermon', $menu-&gt;link);
            $menu-&gt;link = str_replace('serieslist', 'seriesdisplays', $menu-&gt;link);
            $menu-&gt;link = str_replace('seriesdetail', 'seriesdisplay', $menu-&gt;link);
            $menu-&gt;link = str_replace('studieslist', 'sermons', $menu-&gt;link);
            $query      = $db-&gt;getQuery(true);
            $query-&gt;update('#__menu')
                -&gt;set("link = " . $db-&gt;q($menu-&gt;link))
                -&gt;where('id = ' . $db-&gt;q($menu-&gt;id));
            $db-&gt;setQuery($query);
            $db-&gt;execute();
        }
    }

    /**
     * Fix Image paths
     *
     * @since 7.1.0
     *
     * @return   void
     */
    public function fixImagePaths()
    {
        $db    = JFactory::getDBO();
        $query = $db-&gt;getQuery(true);
        $query-&gt;select('*')
            -&gt;from('#__bsms_media');
        $db-&gt;setQuery($query);
        $images = $db-&gt;loadObjectList();

        foreach ($images as $image)
        {
            if (!empty($image-&gt;media_image_path))
            {
                $image-&gt;media_image_path = str_replace('components', 'media', $image-&gt;media_image_path);
                $query                   = $db-&gt;getQuery(true);
                $query-&gt;update('#__bsms_media')
                    -&gt;set("media_image_path = " . $db-&gt;q($image-&gt;media_image_path))
                    -&gt;where('id = ' . $db-&gt;q($image-&gt;id));
                $db-&gt;setQuery($query);
                $db-&gt;execute();
            }
        }
        $query = $db-&gt;getQuery(true);
        $query-&gt;select('*')
            -&gt;from('#__bsms_share');
        $db-&gt;setQuery($query);
        $datas = $db-&gt;loadObjectList();

        foreach ($datas as $data)
        {
            // Need to adjust the params and write back
            $registry = new JRegistry;
            $registry-&gt;loadString($data-&gt;params);
            $params     = $registry;
            $shareimage = $params-&gt;get('shareimage');
            $shareimage = str_replace('components', 'media', $shareimage);
            $params-&gt;set('shareimage', $shareimage);

            // Now write the params back into the $table array and store.
            $data-&gt;params = (string) $params-&gt;toString();
            $qeery        = $db-&gt;getQuery(true);
            $qeery-&gt;update('#__bsms_share')
                -&gt;set('params =' . $db-&gt;q($data-&gt;params))
                -&gt;where('id = ' . $db-&gt;q($data-&gt;id));
            $db-&gt;setQuery($query);
            $db-&gt;execute();
        }
    }

    /**
     * Function to find empty language field and set them to "*"
     *
     * @since 7.1.0
     *
     * @return   void
     */
    public function fixemptylanguage()
    {
        // Tables to fix
        $tables = array(
            array('table' =&gt; '#__bsms_comments'),
            array('table' =&gt; '#__bsms_mediafiles'),
            array('table' =&gt; '#__bsms_series'),
            array('table' =&gt; '#__bsms_studies'),
            array('table' =&gt; '#__bsms_teachers'),
        );

        // Correct blank records
        foreach ($tables as $table)
        {
            $db    = JFactory::getDBO();
            $query = $db-&gt;getQuery(true);
            $query-&gt;update($table['table'])
                -&gt;set('language = ' . $db-&gt;q('*'))
                -&gt;where('language = ' . $db-&gt;q(''));
            $db-&gt;setQuery($query);
            $db-&gt;execute();
        }
    }

    /**
     * Function to Find empty access in the db and set them to Public
     *
     * @since 7.1.0
     *
     * @return   void
     */
    public function fixemptyaccess()
    {
        // Tables to fix
        $tables = array(
            array('table' =&gt; '#__bsms_admin'),
            array('table' =&gt; '#__bsms_mediafiles'),
            array('table' =&gt; '#__bsms_message_type'),
            array('table' =&gt; '#__bsms_mimetype'),
            array('table' =&gt; '#__bsms_order'),
            array('table' =&gt; '#__bsms_podcast'),
            array('table' =&gt; '#__bsms_series'),
            array('table' =&gt; '#__bsms_servers'),
            array('table' =&gt; '#__bsms_share'),
            array('table' =&gt; '#__bsms_studies'),
            array('table' =&gt; '#__bsms_studytopics'),
            array('table' =&gt; '#__bsms_teachers'),
            array('table' =&gt; '#__bsms_templates'),
            array('table' =&gt; '#__bsms_topics'),
        );

        // Get Public id
        $db    = JFactory::getDBO();
        $query = $db-&gt;getQuery(true);
        $query-&gt;select('id')
            -&gt;from('#__viewlevels')
            -&gt;where('title = ' . $db-&gt;q('Public'));
        $db-&gt;setQuery($query);
        $id = $db-&gt;loadResult();

        // Correct blank or not set records
        foreach ($tables as $table)
        {
            $query = $db-&gt;getQuery(true);
            $query-&gt;update($table['table'])
                -&gt;set('access = ' . $id)
                -&gt;where("(access = " . $db-&gt;q('0') . " or access = " . $db-&gt;q('') . ")");
            $db-&gt;setQuery($query);
            $db-&gt;execute();
</codefragment>
  </duplication>
  <duplication lines="53" tokens="87">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/controllers/commentform.php" line="196"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/controllers/mediafileform.php" line="183"/>
    <codefragment>        $append = '';

        // Setup redirect info.
        if ($tmpl)
        {
            $append .= '&amp;tmpl=' . $tmpl;
        }

        $append .= '&amp;layout=edit';

        if ($recordId)
        {
            $append .= '&amp;' . $urlVar . '=' . $recordId;
        }

        $itemId = $this-&gt;input-&gt;getInt('Itemid');
        $return = $this-&gt;getReturnPage();
        $catId  = $this-&gt;input-&gt;getInt('catid', null, 'get');

        if ($itemId)
        {
            $append .= '&amp;Itemid=' . $itemId;
        }

        if ($catId)
        {
            $append .= '&amp;catid=' . $catId;
        }

        if ($return)
        {
            $append .= '&amp;return=' . base64_encode($return);
        }

        return $append;
    }

    /**
     * Get the return URL.
     *
     * If a "return" variable has been passed in the request
     *
     * @return    string    The return URL.
     *
     * @since    1.6
     */
    protected function getReturnPage()
    {
        $return = JFactory::getApplication()-&gt;input-&gt;get('return', null, 'base64');

        if (empty($return) || !JUri::isInternal(base64_decode($return)))
        {
            return JURI::base() . 'index.php?option=com_biblestudy&amp;view=commentlist';
</codefragment>
  </duplication>
  <duplication lines="77" tokens="128">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/controllers/mediafileform.php" line="159"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/controllers/sermon.php" line="142"/>
    <codefragment>        $config = array('ignore_request' =&gt; true))
    {
        $model = parent::getModel($name, $prefix, $config);

        return $model;
    }

    /**
     * Gets the URL arguments to append to an item redirect.
     *
     * @param   int    $recordId  The primary key id for the item.
     * @param   string $urlVar    The name of the URL variable for the id.
     *
     * @return    string    The arguments to append to the redirect URL.
     *
     * @since    1.6
     */
    protected function getRedirectToItemAppend($recordId = null, $urlVar = 'a_id')
    {
        $this-&gt;input = new JInput;

        // Need to override the parent method completely.
        $tmpl   = $this-&gt;input-&gt;get('tmpl');
        $layout = $this-&gt;input-&gt;get('layout', 'edit');
        $append = '';

        // Setup redirect info.
        if ($tmpl)
        {
            $append .= '&amp;tmpl=' . $tmpl;
        }

        $append .= '&amp;layout=edit';

        if ($recordId)
        {
            $append .= '&amp;' . $urlVar . '=' . $recordId;
        }

        $itemId = $this-&gt;input-&gt;getInt('Itemid');
        $return = $this-&gt;getReturnPage();
        $catId  = $this-&gt;input-&gt;getInt('catid', null, 'get');

        if ($itemId)
        {
            $append .= '&amp;Itemid=' . $itemId;
        }

        if ($catId)
        {
            $append .= '&amp;catid=' . $catId;
        }

        if ($return)
        {
            $append .= '&amp;return=' . base64_encode($return);
        }

        return $append;
    }

    /**
     * Get the return URL.
     *
     * If a "return" variable has been passed in the request
     *
     * @return    string    The return URL.
     *
     * @since    1.6
     */
    protected function getReturnPage()
    {
        $return = JFactory::getApplication()-&gt;input-&gt;get('return', null, 'base64');

        if (empty($return) || !JUri::isInternal(base64_decode($return)))
        {
            return JURI::base() . 'index.php?option=com_biblestudy&amp;view=mediafilelist';
</codefragment>
  </duplication>
  <duplication lines="31" tokens="106">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/controller.php" line="250"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/controllers/sermon.php" line="421"/>
    <codefragment>        $query-&gt;select('id, studytitle, studydate')-&gt;from('#__bsms_studies')-&gt;where('id = ' . $comment_study_id);
        $db-&gt;setQuery($query);
        $comment_details    = $db-&gt;loadObject();
        $comment_title      = $comment_details-&gt;studytitle;
        $comment_study_date = $comment_details-&gt;studydate;
        $mail               = JFactory::getMailer();
        $ToEmail            = $params-&gt;get('recipient', '');
        $Subject            = $params-&gt;get('subject', 'Comments');
        $FromName           = $params-&gt;get('fromname', $comment_fromname);

        if (empty($ToEmail))
        {
            $ToEmail = $comment_mailfrom;
        }
        $Body = $comment_author . ' ' . JText::_('JBS_STY_HAS_ENTERED_COMMENT') . ': ' . $comment_title . ' - ' . $comment_study_date . ' '
            . JText::_('JBS_STY_ON') . ': ' . $comment_date;

        if ($comment_published &gt; 0)
        {
            $Body = $Body . ' ' . JText::_('JBS_STY_COMMENT_PUBLISHED');
        }
        else
        {
            $Body = $Body . ' ' . JText::_('JBS_STY_COMMENT_NOT_PUBLISHED');
        }
        $Body = $Body . ' ' . JText::_('JBS_STY_REVIEW_COMMENTS_LOGIN') . ': ' . $comment_livesite;
        $mail-&gt;addRecipient($ToEmail);
        $mail-&gt;setSubject($Subject . ' ' . $comment_livesite);
        $mail-&gt;setBody($Body);
        $mail-&gt;Send();
    }
</codefragment>
  </duplication>
  <duplication lines="35" tokens="77">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/helpers/landing.php" line="59"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/helpers/landing.php" line="277"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/helpers/landing.php" line="1079"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/helpers/landing.php" line="1290"/>
    <codefragment>        else
        {
            $language   = $db-&gt;quote(JFactory::getLanguage()-&gt;getTag()) . ',' . $db-&gt;quote('*');
            $menu_order = null;
        }
        if ($language == '*' || !$language)
        {
            $langlink = '';
        }
        elseif ($language != '*' &amp;&amp; isset($item-&gt;language))
        {
            $langlink = '&amp;amp;filter.languages=' . $item-&gt;language;
        }
        if ($menu_order)
        {
            switch ($menu_order)
            {
                case 2:
                    $order = 'ASC';
                    break;
                case 1:
                    $order = 'DESC';
                    break;
            }
        }
        else
        {
            $order = $params-&gt;get('landing_default_order', 'ASC');
        }
        // Compute view access permissions.
        $groups = implode(',', $user-&gt;getAuthorisedViewLevels());

        $query = $db-&gt;getQuery(true);
        $query-&gt;select('distinct a.*')
            -&gt;from('#__bsms_locations a')
</codefragment>
  </duplication>
  <duplication lines="13" tokens="78">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/helpers/teacher.php" line="127"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/helpers/teacher.php" line="162"/>
    <codefragment>        $label = str_replace('{{teacher}}', $row-&gt;teachername, $label);
        $label = str_replace('{{title}}', $row-&gt;title, $label);
        $label = str_replace('{{phone}}', $row-&gt;phone, $label);
        $label = str_replace('{{website}}', '&lt;A href="' . $row-&gt;website . '"&gt;Website&lt;/a&gt;', $label);
        $label = str_replace('{{information}}', $row-&gt;information, $label);
        $label = str_replace('{{image}}', '&lt;img src="' . $imagelarge-&gt;path . '" width="' . $imagelarge-&gt;width . '" height="' . $imagelarge-&gt;height . '" /&gt;', $label);
        $label = str_replace('{{short}}', $row-&gt;short, $label);
        $label = str_replace('{{thumbnail}}', '&lt;img src="' . $imagesmall-&gt;path . '" width="' . $imagesmall-&gt;width . '" height="' . $imagesmall-&gt;height . '" /&gt;', $label);
        $label = str_replace('{{url}}', JRoute::_('index.php?option=com_biblestudy&amp;amp;view=teacherdisplay&amp;amp;id=' . $row-&gt;id . '&amp;amp;t=' . $template), $label);

        return $label;
    }

</codefragment>
  </duplication>
  <duplication lines="28" tokens="71">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/helpers/image.php" line="43"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/lib/images.php" line="37"/>
    <codefragment>        if (!empty($path))
        {
            $tmp-&gt;size = filesize($tmp-&gt;path);
            $ext       = strtolower(JFile::getExt($path));

            switch ($ext)
            {
                // Image
                case 'jpg':
                case 'png':
                case 'gif':
                case 'xcf':
                case 'odg':
                case 'bmp':
                case 'jpeg':
                    $info        = getimagesize($tmp-&gt;path);
                    $tmp-&gt;width  = $info[0];
                    $tmp-&gt;height = $info[1];
                    $tmp-&gt;type   = $info[2];
                    $tmp-&gt;mime   = $info['mime'];

                    if (!$tmp-&gt;width)
                    {
                        $tmp-&gt;width = 0;
                    }
                    if (!$tmp-&gt;height)
                    {
                        $tmp-&gt;height = 0;
</codefragment>
  </duplication>
  <duplication lines="25" tokens="78">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/lib/listing.php" line="1511"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/lib/listing.php" line="1548"/>
    <codefragment>                case 0:
                    $title .= null;
                    break;
                case 1:
                    $title .= $row-&gt;studytitle;
                    break;
                case 2:
                    $title .= $row-&gt;teachername;
                    break;
                case 3:
                    $title .= $row-&gt;title . ' ' . $row-&gt;teachername;
                    break;
                case 4:
                    $esv       = 0;
                    $scripture = $this-&gt;getScripture($params, $row, $esv, $scripturerow = 1);
                    $title .= $scripture;
                    break;
                case 5:
                    $title .= $row-&gt;stext;
                    break;
                case 6:
                    $title .= $row-&gt;topics_text;
                    break;
                case 7:
                    $elementid = $custom-&gt;getCustom($rowid = 0, $params-&gt;get('customtitle1'), $row, $params, $admin_params, $template);
</codefragment>
  </duplication>
  <duplication lines="123" tokens="775">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/lib/listing.php" line="42"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/lib/listing.php" line="1615"/>
    <codefragment>        if ($view == 'sermon' &amp;&amp; $ismodule &lt; 1)
        {

            $params-&gt;set('row1col1', $params-&gt;get('drow1col1'));
            $params-&gt;set('r1c1custom', $params-&gt;get('dr1c1custom'));
            $params-&gt;set('r1c1customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('r1c1span', $params-&gt;get('dr1c1span'));
            $params-&gt;set('linkr1c1', $params-&gt;get('dlinkr1c1'));

            $params-&gt;set('row1col2', $params-&gt;get('drow1col2'));
            $params-&gt;set('r1c2custom', $params-&gt;get('dr1c2custom'));
            $params-&gt;set('r1c2customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('r1c2span', $params-&gt;get('dr1c2span'));
            $params-&gt;set('linkr1c2', $params-&gt;get('dlinkr1c2'));

            $params-&gt;set('row1col3', $params-&gt;get('drow1col3'));
            $params-&gt;set('r1c3custom', $params-&gt;get('dr1c3custom'));
            $params-&gt;set('r1c3customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('r1c3span', $params-&gt;get('dr1c3span'));
            $params-&gt;set('linkr1c3', $params-&gt;get('dlinkr1c3'));

            $params-&gt;set('row1col4', $params-&gt;get('drow1col4'));
            $params-&gt;set('r1c4custom', $params-&gt;get('dr1c4custom'));
            $params-&gt;set('r1c4customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('linkr1c4', $params-&gt;get('dlinkr1c4'));

            $params-&gt;set('row2col1', $params-&gt;get('drow2col1'));
            $params-&gt;set('r2c1custom', $params-&gt;get('dr2c1custom'));
            $params-&gt;set('r2c1customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('r2c1span', $params-&gt;get('dr2c1span'));
            $params-&gt;set('linkr2c1', $params-&gt;get('dlinkr2c1'));

            $params-&gt;set('row2col2', $params-&gt;get('drow2col2'));
            $params-&gt;set('r2c2custom', $params-&gt;get('dr2c2custom'));
            $params-&gt;set('r2c2customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('r2c2span', $params-&gt;get('dr2c2span'));
            $params-&gt;set('linkr2c2', $params-&gt;get('dlinkr2c2'));

            $params-&gt;set('row2col3', $params-&gt;get('drow2col3'));
            $params-&gt;set('r2c3custom', $params-&gt;get('dr2c3custom'));
            $params-&gt;set('r2c3customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('r2c3span', $params-&gt;get('dr2c3span'));
            $params-&gt;set('linkr2c3', $params-&gt;get('dlinkr2c3'));

            $params-&gt;set('row2col4', $params-&gt;get('drow2col4'));
            $params-&gt;set('r2c4custom', $params-&gt;get('dr2c4custom'));
            $params-&gt;set('r2c4customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('linkr2c4', $params-&gt;get('dlinkr2c4'));

            $params-&gt;set('row3col1', $params-&gt;get('drow3col1'));
            $params-&gt;set('r3c1custom', $params-&gt;get('dr3c1custom'));
            $params-&gt;set('r3c1customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('r3c1span', $params-&gt;get('dr3c1span'));
            $params-&gt;set('linkr3c1', $params-&gt;get('dlinkr3c1'));

            $params-&gt;set('row3col2', $params-&gt;get('drow3col2'));
            $params-&gt;set('r3c2custom', $params-&gt;get('dr3c2custom'));
            $params-&gt;set('r3c2customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('r3c2span', $params-&gt;get('dr3c2span'));
            $params-&gt;set('linkr3c2', $params-&gt;get('dlinkr3c2'));

            $params-&gt;set('row3col3', $params-&gt;get('drow3col3'));
            $params-&gt;set('r3c3custom', $params-&gt;get('dr3c3custom'));
            $params-&gt;set('r3c3customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('r3c3span', $params-&gt;get('dr3c3span'));
            $params-&gt;set('linkr3c3', $params-&gt;get('dlinkr3c3'));

            $params-&gt;set('row3col4', $params-&gt;get('drow3col4'));
            $params-&gt;set('r3c4custom', $params-&gt;get('dr3c4custom'));
            $params-&gt;set('r3c4customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('linkr3c4', $params-&gt;get('dlinkr3c4'));

            $params-&gt;set('row4col1', $params-&gt;get('drow4col1'));
            $params-&gt;set('r4c1custom', $params-&gt;get('dr4c1custom'));
            $params-&gt;set('r4c1customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('r4c1span', $params-&gt;get('dr4c1span'));
            $params-&gt;set('linkr4c1', $params-&gt;get('dlinkr4c1'));

            $params-&gt;set('row4col2', $params-&gt;get('drow4col2'));
            $params-&gt;set('r4c2custom', $params-&gt;get('dr4c2custom'));
            $params-&gt;set('r4c2customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('r4c2span', $params-&gt;get('dr4c2span'));
            $params-&gt;set('linkr4c2', $params-&gt;get('dlinkr4c2'));

            $params-&gt;set('row4col3', $params-&gt;get('drow4col3'));
            $params-&gt;set('r4c3custom', $params-&gt;get('dr4c3custom'));
            $params-&gt;set('r4c3customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('r4c3span', $params-&gt;get('dr4c3span'));
            $params-&gt;set('linkr4c3', $params-&gt;get('dlinkr4c3'));

            $params-&gt;set('row4col4', $params-&gt;get('drow4col4'));
            $params-&gt;set('r4c4custom', $params-&gt;get('dr4c4custom'));
            $params-&gt;set('r4c4customlabel', $params-&gt;get('dr1c1customlabel'));
            $params-&gt;set('linkr4c4', $params-&gt;get('dlinkr4c4'));
        }

        // Need to know if last column and last row
        $columns = 1;

        if ($params-&gt;get('row1col2') &gt; 0 || $params-&gt;get('row2col2') &gt; 0 || $params-&gt;get('row3col2') &gt; 0 || $params-&gt;get('row4col2') &gt; 0)
        {
            $columns = 2;
        }
        if ($params-&gt;get('row1col3') &gt; 0 || $params-&gt;get('row2col3') &gt; 0 || $params-&gt;get('row3col3') &gt; 0 || $params-&gt;get('row4col3') &gt; 0)
        {
            $columns = 3;
        }
        if ($params-&gt;get('row1col4') &gt; 0 || $params-&gt;get('row2col4') &gt; 0 || $params-&gt;get('row3col4') &gt; 0 || $params-&gt;get('row4col4') &gt; 0)
        {
            $columns = 4;
        }
        $rows = 1;

        if ($params-&gt;get('row2col1') &gt; 0 || $params-&gt;get('row2col2') &gt; 0 || $params-&gt;get('row2col3') &gt; 0 || $params-&gt;get('row2col4') &gt; 0)
        {
            $rows = 2;
        }
        if ($params-&gt;get('row3col1') &gt; 0 || $params-&gt;get('row3col2') &gt; 0 || $params-&gt;get('row3col3') &gt; 0 || $params-&gt;get('row3col4') &gt; 0)
        {
            $rows = 3;
        }
        if ($params-&gt;get('row4col1') &gt; 0 || $params-&gt;get('row4col2') &gt; 0 || $params-&gt;get('row4col3') &gt; 0 || $params-&gt;get('row4col4') &gt; 0)
        {
</codefragment>
  </duplication>
  <duplication lines="50" tokens="79">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/fields/docman.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/models/fields/docman.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

// Import the list field type
jimport('joomla.form.helper');
JFormHelper::loadFieldClass('list');

/**
 * Virtuemart Category List Form Field class for the Joomla Bible Study component
 *
 * @package  BibleStudy.Admin
 * @since    7.0.4
 */
class JFormFieldDocman extends JFormFieldList
{

    /**
     * The field type.
     *
     * @var         string
     */
    protected $type = 'Docman';

    /**
     * Method to get a list of options for a list input.
     *
     * @return      array           An array of JHtml options.
     */
    protected function getOptions()
    {
        /* @todo check for docman 2.0 way of doing this */
        // Check to see if Docman is installed
        jimport('joomla.filesystem.folder');

        if (!JFolder::exists(JPATH_ADMINISTRATOR . DIRECTORY_SEPARATOR . 'components' . DIRECTORY_SEPARATOR . 'com_docman'))
        {
            return JText::_('JBS_CMN_DOCMAN_NOT_INSTALLED');
        }

        $db    = JFactory::getDBO();
        $query = $db-&gt;getQuery(true);
        $query-&gt;select('dm.id, dm.dmname');
        $query-&gt;from('#__docman AS dm');
        $query-&gt;order('dm.id DESC');
        $db-&gt;setQuery((string) $query);
        $docs    = $db-&gt;loadObjectList();
        $options = array();

        if ($docs)
        {
            $options[] = JHtml::_('select.option', '-1', JTEXT::_('JBS_MED_SELECT_DOCMAN'));
</codefragment>
  </duplication>
  <duplication lines="53" tokens="123">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/fields/filesize.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/models/fields/filesize.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

jimport('joomla.html.html');
jimport('joomla.access.access');
jimport('joomla.form.formfield');

/**
 * Form Field class for the FileSize
 *
 * @package  BibleStudy.Admin
 * @since    7.0.0
 */
class JFormFieldFilesize extends JFormField
{

    /**
     *  Set Naming of type
     *
     * @var string
     */
    public $type = 'Filesize';

    /**
     * Get impute of form
     *
     * @return string
     */
    protected function getInput()
    {
        // Initialize some field attributes.
        $size      = $this-&gt;element['size'] ? ' size="' . (int) $this-&gt;element['size'] . '"' : '';
        $maxLength = $this-&gt;element['maxlength'] ? ' maxlength="' . (int) $this-&gt;element['maxlength'] . '"' : '';
        $class     = $this-&gt;element['class'] ? ' class="' . (string) $this-&gt;element['class'] . '"' : '';
        $readonly  = ((string) $this-&gt;element['readonly'] == 'true') ? ' readonly="readonly"' : '';
        $disabled  = ((string) $this-&gt;element['disabled'] == 'true') ? ' disabled="disabled"' : '';

        // Initialize JavaScript field attributes.
        $onchange = $this-&gt;element['onchange'] ? ' onchange="' . (string) $this-&gt;element['onchange'] . '"' : '';

        return '&lt;input type="text" name="' . $this-&gt;name . '" id="' . $this-&gt;id . '"' .
        ' value="' . htmlspecialchars($this-&gt;value, ENT_COMPAT, 'UTF-8') . '"' .
        $class . $size . $disabled . $readonly . $onchange . $maxLength . '/&gt;' . $this-&gt;sizeConverter();
    }

    /**
     * Returns converted size
     *
     * @return string
     */
    private function sizeConverter()
    {
        JHTML::Script('filesize.js', JURI::root() . '/media/com_biblestudy/js/');

</codefragment>
  </duplication>
  <duplication lines="32" tokens="73">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/fields/modal/study.php" line="72"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/models/fields/modal/study.php" line="72"/>
    <codefragment>        $html[] = '  &lt;input type="text" id="' . $this-&gt;id . '_name" value="' . $title . '" disabled="disabled" size="35" /&gt;';
        $html[] = '&lt;/div&gt;';

        // The user select button.
        $html[] = '&lt;div class="button2-left"&gt;';
        $html[] = '  &lt;div class="blank"&gt;';
        $html[] = '    &lt;a class="modal" title="' . JText::_('JBS_CMN_STUDY_CHANGE') . '"  href="' . $link . '" rel="{handler: \'iframe\', size: {x: 800, y: 450}}"&gt;' . JText::_('JBS_CMN_STUDY_CHANGE') . '&lt;/a&gt;';
        $html[] = '  &lt;/div&gt;';
        $html[] = '&lt;/div&gt;';

        // The active article id field.
        if (0 == (int) $this-&gt;value) {
            $value = '';
        } else {
            $value = (int) $this-&gt;value;
        }

        // class='required' for client side validation
        $class = '';
        if ($this-&gt;required) {
            $class = ' class="required modal-value"';
        }

        $html[] = '&lt;input type="hidden" id="' . $this-&gt;id . '_id"' . $class . ' name="' . $this-&gt;name . '" value="' . $value . '" /&gt;';

        return implode("\n", $html);
    }

}</codefragment>
  </duplication>
  <duplication lines="32" tokens="79">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/fields/modal/seriesdetail.php" line="38"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/models/fields/modal/studydetails.php" line="39"/>
    <codefragment>    protected function getInput() {
        // Load the javascript and css
        JHtml::_('behavior.framework');
        JHTML::_('script', 'system/modal.js', false, true);
        JHTML::_('stylesheet', 'system/modal.css', array(), true);

        // Build the script.
        $script = array();
        $script[] = '    function jSelectChart_' . $this-&gt;id . '(id, name, object) {';
        $script[] = '        document.id("' . $this-&gt;id . '_id").value = id;';
        $script[] = '        document.id("' . $this-&gt;id . '_name").value = name;';
        $script[] = '        SqueezeBox.close();';
        $script[] = '    }';

        // Add the script to the document head.
        JFactory::getDocument()-&gt;addScriptDeclaration(implode("\n", $script));

        // Build the script.
        $script = array();
        $script[] = '    window.addEvent("domready", function() {';
        $script[] = '        var div = new Element("div").setStyle("display", "none").injectBefore(document.id("menu-types"));';
        $script[] = '        document.id("menu-types").injectInside(div);';
        $script[] = '        SqueezeBox.initialize();';
        $script[] = '        SqueezeBox.assign($$("input.modal"), {parse:"rel"});';
        $script[] = '    });';

        // Add the script to the document head.
        JFactory::getDocument()-&gt;addScriptDeclaration(implode("\n", $script));


        // Get the title of the linked chart
        $db = JFactory::getDBO();
</codefragment>
  </duplication>
  <duplication lines="65" tokens="129">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/fields/virtuemart.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/models/fields/virtuemart.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

// Import the list field type
jimport('joomla.form.helper');

JFormHelper::loadFieldClass('list');

/**
 * Virtuemart Category List Form Field class for the Joomla Bible Study component
 *
 * @package  BibleStudy.Admin
 * @since    7.0.4
 */
class JFormFieldVirtuemart extends JFormFieldList
{

    /**
     * The field type.
     *
     * @var         string
     */
    protected $type = 'Virtuemart';

    /**
     * Method to get a list of options for a list input.
     *
     * @return      array           An array of JHtml options.
     */
    protected function getOptions()
    {
        $params = JComponentHelper::getParams('com_languages');

        // Use default joomla
        $siteLang = $params-&gt;get('site', 'en-GB');
        $lang     = strtolower(strtr($siteLang, '-', '_'));
        define('VMLANG', $lang);

        // Check to see if component installed
        jimport('joomla.filesystem.folder');

        if (!JFolder::exists(JPATH_ADMINISTRATOR . DIRECTORY_SEPARATOR . 'components' . DIRECTORY_SEPARATOR . 'com_virtuemart'))
        {
            return JText::_('JBS_CMN_VIRTUEMART_NOT_INSTALLED');
        }
        $db    = JFactory::getDBO();
        $query = $db-&gt;getQuery(true);
        $query-&gt;select('v.virtuemart_product_id, v.product_name');
        $query-&gt;from('#__virtuemart_products_' . VMLANG . ' AS v');
        $query-&gt;select('p.product_sku');
        $query-&gt;join('LEFT', '#__virtuemart_products as p ON v.virtuemart_product_id = p.virtuemart_product_id');
        $query-&gt;order('v.virtuemart_product_id DESC');
        $db-&gt;setQuery((string) $query);
        $products = $db-&gt;loadObjectList();
        $options  = array();

        if ($products)
        {
            foreach ($products as $product)
            {
                $options[] = JHtml::_('select.option', $product-&gt;virtuemart_product_id, $product-&gt;product_name . ' (' . $product-&gt;product_sku . ')');
            }
        }
        $options = array_merge(parent::getOptions(), $options);

        return $options;
</codefragment>
  </duplication>
  <duplication lines="16" tokens="78">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/messages.php" line="188"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/models/sermons.php" line="105"/>
    <codefragment>        $studytitle = $this-&gt;getUserStateFromRequest($this-&gt;context . '.filter.studytitle', 'filter_studytitle');
        $this-&gt;setState('filter.studytitle', $studytitle);

        $published = $this-&gt;getUserStateFromRequest($this-&gt;context . '.filter.published', 'filter_published', '');
        $this-&gt;setState('filter.published', $published);

        $book = $this-&gt;getUserStateFromRequest($this-&gt;context . '.filter.book', 'filter_book');
        $this-&gt;setState('filter.book', $book);

        $teacher = $this-&gt;getUserStateFromRequest($this-&gt;context . '.filter.teacher', 'filter_teacher');
        $this-&gt;setState('filter.teacher', $teacher);

        $series = $this-&gt;getUserStateFromRequest($this-&gt;context . '.filter.series', 'filter_series');
        $this-&gt;setState('filter.series', $series);

        $messageType = $this-&gt;getUserStateFromRequest($this-&gt;context . '.filter.messagetype', 'filter_messagetype');
</codefragment>
  </duplication>
  <duplication lines="49" tokens="89">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/messages.php" line="425"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/models/sermons.php" line="716"/>
    <codefragment>        $query-&gt;join('INNER', '#__bsms_studies AS study ON study.booknumber = book.booknumber');
        $query-&gt;group('book.id');
        $query-&gt;order('book.booknumber');
        $db-&gt;setQuery($query-&gt;__toString());
        $db_result = $db-&gt;loadAssocList();

        foreach ($db_result as $i =&gt; $value)
        {
            $db_result[$i]['text'] = JText::_($value['text']);
        }

        return $db_result;
    }

    /**
     * Get a list of all used teachers
     *
     * @since 7.0
     * @return object
     */
    public function getTeachers()
    {
        $db    = $this-&gt;getDbo();
        $query = $db-&gt;getQuery(true);
        $query-&gt;select('teacher.id AS value, teacher.teachername AS text');
        $query-&gt;from('#__bsms_teachers AS teacher');
        $query-&gt;join('INNER', '#__bsms_studies AS study ON study.teacher_id = teacher.id');
        $query-&gt;group('teacher.id');
        $query-&gt;order('teacher.teachername');
        $db-&gt;setQuery($query-&gt;__toString());

        return $db-&gt;loadObjectList();
    }

    /**
     * Get a list of all used series
     *
     * @since 7.0
     * @return object
     */
    public function getSeries()
    {
        $db    = $this-&gt;getDbo();
        $query = $db-&gt;getQuery(true);
        $query-&gt;select('series.id AS value, series.series_text AS text');
        $query-&gt;from('#__bsms_series AS series');
        $query-&gt;join('INNER', '#__bsms_studies AS study ON study.series_id = series.id');
        $query-&gt;group('series.id');
        $query-&gt;order('series.series_text');
</codefragment>
  </duplication>
  <duplication lines="47" tokens="87">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/models/messages.php" line="473"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/models/sermons.php" line="777"/>
    <codefragment>        $query-&gt;order('series.series_text');
        $db-&gt;setQuery($query-&gt;__toString());

        return $db-&gt;loadObjectList();
    }

    /**
     * Get a list of all used message types
     *
     * @since 7.0
     * @return object
     */
    public function getMessageTypes()
    {
        $db    = $this-&gt;getDbo();
        $query = $db-&gt;getQuery(true);
        $query-&gt;select('messageType.id AS value, messageType.message_type AS text');
        $query-&gt;from('#__bsms_message_type AS messageType');
        $query-&gt;join('INNER', '#__bsms_studies AS study ON study.messagetype = messageType.id');
        $query-&gt;group('messageType.id');
        $query-&gt;order('messageType.message_type');
        $db-&gt;setQuery($query-&gt;__toString());

        return $db-&gt;loadObjectList();
    }

    /**
     * get a list of all used years
     *
     * @return object
     *
     * @since 7.0
     */
    public function getYears()
    {
        // Create a new query object.
        $db    = $this-&gt;getDBO();
        $query = $db-&gt;getQuery(true);

        // Construct the query
        $query-&gt;select('DISTINCT YEAR(studydate) as value, YEAR(studydate) as text');
        $query-&gt;from('#__bsms_studies');
        $query-&gt;order('value');

        // Setup the query
        $db-&gt;setQuery($query-&gt;__toString());

</codefragment>
  </duplication>
  <duplication lines="32" tokens="73">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/tmpl/default.php" line="24"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/commentlist/tmpl/default.php" line="29"/>
    <codefragment>JHtml::_('behavior.multiselect');

$app = JFactory::getApplication();
$user = JFactory::getUser();
$userId = $user-&gt;get('id');
$listOrder = $this-&gt;escape($this-&gt;state-&gt;get('list.ordering'));
$listDirn = $this-&gt;escape($this-&gt;state-&gt;get('list.direction'));
$archived = $this-&gt;state-&gt;get('filter.published') == 2 ? true : false;
$trashed = $this-&gt;state-&gt;get('filter.published') == -2 ? true : false;
$saveOrder = $listOrder == 'ordering';
$sortFields = $this-&gt;getSortFields();
?&gt;
&lt;script type="text/javascript"&gt;
    Joomla.orderTable = function () {
        table = document.getElementById("sortTable");
        direction = document.getElementById("directionTable");
        order = table.options[table.selectedIndex].value;
        if (order != '&lt;?php echo $listOrder; ?&gt;') {
            dirn = 'asc';
        } else {
            dirn = direction.options[direction.selectedIndex].value;
        }
        Joomla.tableOrdering(order, dirn, '');
    }
&lt;/script&gt;
&lt;form action="&lt;?php echo JRoute::_('index.php?option=com_biblestudy&amp;view=comments'); ?&gt;" method="post" name="adminForm"
      id="adminForm"&gt;
    &lt;?php if (!empty($this-&gt;sidebar)): ?&gt;
    &lt;div id="j-sidebar-container" class="span2"&gt;
        &lt;?php echo $this-&gt;sidebar; ?&gt;
    &lt;/div&gt;
    &lt;div id="j-main-container" class="span10"&gt;
</codefragment>
  </duplication>
  <duplication lines="49" tokens="128">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/tmpl/default.php" line="164"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/commentlist/tmpl/default.php" line="173"/>
    <codefragment>                            &lt;?php echo JHtml::_('jgrid.published', $item-&gt;published, $i, 'comments.', $canChange, 'cb', '', ''); ?&gt;
                        &lt;/td&gt;

                        &lt;td class="nowrap has-context"&gt;
                            &lt;div class="pull-left"&gt;
                                &lt;?php if ($canEdit || $canEditOwn) : ?&gt;
                                    &lt;a href="&lt;?php echo $link; ?&gt;"&gt;&lt;?php echo $this-&gt;escape($item-&gt;studytitle) . ' - ' . JText::_($item-&gt;bookname) . ' ' . $item-&gt;chapter_begin; ?&gt;&lt;/a&gt;
                                &lt;?php else : ?&gt;
                                    &lt;?php echo $this-&gt;escape($item-&gt;studytitle) . ' - ' . JText::_($item-&gt;bookname) . ' ' . $item-&gt;chapter_begin; ?&gt;
                                &lt;?php endif; ?&gt;
                            &lt;/div&gt;
                            &lt;div class="pull-left"&gt;
                                &lt;?php
                                if (BIBLESTUDY_CHECKREL)
                                {
                                    // Create dropdown items
                                    JHtml::_('dropdown.edit', $item-&gt;id, 'comment.');
                                    JHtml::_('dropdown.divider');
                                    if ($item-&gt;published) :
                                        JHtml::_('dropdown.unpublish', 'cb' . $i, 'comments.');
                                    else :
                                        JHtml::_('dropdown.publish', 'cb' . $i, 'comments.');
                                    endif;

                                    JHtml::_('dropdown.divider');

                                    if ($archived) :
                                        JHtml::_('dropdown.unarchive', 'cb' . $i, 'comments.');
                                    else :
                                        JHtml::_('dropdown.archive', 'cb' . $i, 'comments.');
                                    endif;

                                    if ($trashed) :
                                        JHtml::_('dropdown.untrash', 'cb' . $i, 'comments.');
                                    else :
                                        JHtml::_('dropdown.trash', 'cb' . $i, 'comments.');
                                    endif;

                                    // Render dropdown list
                                    echo JHtml::_('dropdown.render');
                                }
                                ?&gt;
                            &lt;/div&gt;
                        &lt;/td&gt;
                        &lt;td class="small hidden-phone"&gt;
                            &lt;?php echo $this-&gt;escape($item-&gt;access_level); ?&gt;
                        &lt;/td&gt;
                        &lt;td class="nowrap has-context"&gt;
                            &lt;?php echo $item-&gt;full_name; ?&gt;
</codefragment>
  </duplication>
  <duplication lines="16" tokens="112">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/comments/view.html.php" line="83"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/commentlist/view.html.php" line="78"/>
    <codefragment>        $options   = array();
        $options[] = JHtml::_('select.option', '1', JText::_('J1'));
        $options[] = JHtml::_('select.option', '2', JText::_('J2'));
        $options[] = JHtml::_('select.option', '3', JText::_('J3'));
        $options[] = JHtml::_('select.option', '4', JText::_('J4'));
        $options[] = JHtml::_('select.option', '5', JText::_('J5'));
        $options[] = JHtml::_('select.option', '6', JText::_('J6'));
        $options[] = JHtml::_('select.option', '7', JText::_('J7'));
        $options[] = JHtml::_('select.option', '8', JText::_('J8'));
        $options[] = JHtml::_('select.option', '9', JText::_('J9'));
        $options[] = JHtml::_('select.option', '10', JText::_('J10'));

        $this-&gt;f_levels = $options;

        // We don't need toolbar in the modal window.
        if ($this-&gt;getLayout() !== 'modal')
</codefragment>
  </duplication>
  <duplication lines="54" tokens="96">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/admin/views/mediafile/tmpl/edit.php" line="36"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/mediafileform/tmpl/edit.php" line="51"/>
    <codefragment>$study = $app-&gt;getUserState($option . 'sid');
$sdate = $app-&gt;getUserState($option . 'sdate');
$size = $app-&gt;getUserState($option . 'size');
$fname = $app-&gt;getUserState($option . 'fname');
$serverid = $app-&gt;getUserState($option . 'serverid');

if ($this-&gt;item-&gt;server)
{
    $server = $this-&gt;item-&gt;server;
}
elseif ($serverid)
{
    $server = $serverid;
}
elseif (empty($this-&gt;item-&gt;study_id))
{
    $server = $this-&gt;admin_params-&gt;get('server');
}
$folderid = $app-&gt;getUserState('folderid');
if ($this-&gt;item-&gt;path)
{
    $folder = $this-&gt;item-&gt;path;
}
elseif ($folderid)
{
    $folder = $folderid;
}
elseif (empty($this-&gt;item-&gt;study_id))
{
    $folder = $this-&gt;admin_params-&gt;get('path');
}
?&gt;
&lt;script&gt;
    function openConverter1() {
        var Wheight = 125;
        var Wwidth = 300;
        var winl = (screen.width - Wwidth) / 2;
        var wint = (screen.height - Wheight) / 2;

        var msg1 = window.open("components/com_biblestudy/convert1.htm", "Window", "scrollbars=1,width=" + Wwidth + ",height=" + Wheight + ",top=" + wint + ",left=" + winl);
        if (!msg1.closed) {
            msg1.focus();
        }
    }
&lt;/script&gt;
&lt;script type="text/javascript"&gt;
    Joomla.submitbutton = function (task) {
        if (task == 'mediafile.cancel' || document.formvalidator.isValid(document.id('item-form'))) {
            Joomla.submitform(task, document.getElementById('item-form'));
        }
    };
    function submitbutton(task) {
        if (task == '') {
            return false;
</codefragment>
  </duplication>
  <duplication lines="28" tokens="112">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/commentlist/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/mediafilelist/tmpl/default.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

if (BIBLESTUDY_CHECKREL)
{
    JHtml::addIncludePath(JPATH_COMPONENT . '/helpers/html');
    JHtml::_('bootstrap.tooltip');
    JHtml::_('dropdown.init');
    JHtml::_('formbehavior.chosen', 'select');
}
else
{
    JHtml::_('behavior.tooltip');
    JHtml::stylesheet('media/com_biblestudy/css/biblestudy-j2.5.css');
    JHtml::stylesheet('media/com_biblestudy/jui/css/bootstrap.css');
    JHtml::script('media/com_biblestudy/jui/js/jquery.js');
    JHtml::script('media/com_biblestudy/jui/js/jquery-noconflict.js');
    JHtml::script('media/com_biblestudy/jui/js/bootstrap.js');
}
JHtml::_('behavior.multiselect');

$app = JFactory::getApplication();
$user = JFactory::getUser();
$userId = $user-&gt;get('id');
$listOrder = $this-&gt;escape($this-&gt;state-&gt;get('list.ordering'));
$listDirn = $this-&gt;escape($this-&gt;state-&gt;get('list.direction'));
$archived = $this-&gt;state-&gt;get('filter.published') == 2 ? true : false;
$trashed = $this-&gt;state-&gt;get('filter.published') == -2 ? true : false;
$saveOrder = $listOrder == 'ordering';
</codefragment>
  </duplication>
  <duplication lines="26" tokens="107">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/mediafileform/view.html.php" line="208"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/mediafilelist/view.html.php" line="162"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/messageform/view.html.php" line="219"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/messagelist/view.html.php" line="160"/>
    <codefragment>        if ($app-&gt;getCfg('sitename_pagetitles', 0) == 1)
        {
            $title = JText::sprintf('JPAGETITLE', $app-&gt;getCfg('sitename'), $title);
        }
        elseif ($app-&gt;getCfg('sitename_pagetitles', 0) == 2)
        {
            $title = JText::sprintf('JPAGETITLE', $title, $app-&gt;getCfg('sitename'));
        }
        $this-&gt;document-&gt;setTitle($title);

        $pathway = $app-&gt;getPathWay();
        $pathway-&gt;addItem($title, '');

        if ($this-&gt;params-&gt;get('menu-meta_description'))
        {
            $this-&gt;document-&gt;setDescription($this-&gt;params-&gt;get('menu-meta_description'));
        }

        if ($this-&gt;params-&gt;get('menu-meta_keywords'))
        {
            $this-&gt;document-&gt;setMetadata('keywords', $this-&gt;params-&gt;get('menu-meta_keywords'));
        }

        if ($this-&gt;params-&gt;get('robots'))
        {
            $this-&gt;document-&gt;setMetadata('robots', $this-&gt;params-&gt;get('robots'));
</codefragment>
  </duplication>
  <duplication lines="37" tokens="85">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/mediafileform/view.html.php" line="169"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/messageform/view.html.php" line="180"/>
    <codefragment>        parent::display($tpl);
    }

    /**
     * Prepares the document
     *
     * @return void
     */
    protected function _prepareDocument()
    {
        $app     = JFactory::getApplication();
        $menus   = $app-&gt;getMenu();
        $pathway = $app-&gt;getPathway();
        $title   = null;

        // Because the application sets a default page title,
        // we need to get it from the menu item itself
        $menu = $menus-&gt;getActive();

        if ($menu)
        {
            $this-&gt;params-&gt;def('page_heading', $this-&gt;params-&gt;get('page_title', $menu-&gt;title));
        }
        else
        {
            $this-&gt;params-&gt;def('page_heading', JText::_('JBS_FORM_EDIT_ARTICLE'));
        }
        if (JBSPAGETITLE)
        {
            $title = $this-&gt;params-&gt;def('page_title', '');
        }
        else
        {
            $title = JText::_('JBS_CMN_JOOMLA_BIBLE_STUDY');
        }
        $isNew = ($this-&gt;item-&gt;id == 0);
        $state = $isNew ? JText::_('JBS_CMN_NEW') : JText::sprintf('JBS_CMN_EDIT', $this-&gt;form-&gt;getValue('studytitle'));
</codefragment>
  </duplication>
  <duplication lines="30" tokens="116">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/commentlist/tmpl/default.php" line="11"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/messagelist/tmpl/default.php" line="11"/>
    <codefragment>defined('_JEXEC') or die;

if (BIBLESTUDY_CHECKREL)
{
    JHtml::addIncludePath(JPATH_COMPONENT . '/helpers/html');
    JHtml::_('bootstrap.tooltip');
    JHtml::_('dropdown.init');
    JHtml::_('formbehavior.chosen', 'select');
}
else
{
    JHtml::_('behavior.tooltip');
    JHtml::stylesheet('media/com_biblestudy/css/biblestudy-j2.5.css');
    JHtml::stylesheet('media/com_biblestudy/jui/css/bootstrap.css');
    JHtml::script('media/com_biblestudy/jui/js/jquery.js');
    JHtml::script('media/com_biblestudy/jui/js/jquery-noconflict.js');
    JHtml::script('media/com_biblestudy/jui/js/bootstrap.js');
}
JHtml::_('behavior.multiselect');

$app = JFactory::getApplication();
$user = JFactory::getUser();
$userId = $user-&gt;get('id');
$listOrder = $this-&gt;escape($this-&gt;state-&gt;get('list.ordering'));
$listDirn = $this-&gt;escape($this-&gt;state-&gt;get('list.direction'));
$archived = $this-&gt;state-&gt;get('filter.published') == 2 ? true : false;
$trashed = $this-&gt;state-&gt;get('filter.published') == -2 ? true : false;
$saveOrder = $listOrder == 'ordering';
$sortFields = $this-&gt;getSortFields();

</codefragment>
  </duplication>
  <duplication lines="32" tokens="70">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/mediafilelist/view.html.php" line="129"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/messagelist/view.html.php" line="127"/>
    <codefragment>        $this-&gt;_prepareDocument();

        parent::display($tpl);
    }

    /**
     * Prepares the document
     *
     * @return void
     */
    protected function _prepareDocument()
    {
        $app     = JFactory::getApplication();
        $menus   = $app-&gt;getMenu();
        $pathway = $app-&gt;getPathway();
        $title   = null;

        // Because the application sets a default page title,
        // we need to get it from the menu item itself
        $menu = $menus-&gt;getActive();

        if ($menu)
        {
            $this-&gt;params-&gt;def('page_heading', $this-&gt;params-&gt;get('page_title', $menu-&gt;title));
        }
        else
        {
            $this-&gt;params-&gt;def('page_heading', JText::_('JBS_FORM_EDIT_ARTICLE'));
        }

        $title = $this-&gt;params-&gt;def('page_title', '');
        $title .= ' : ' . JText::_('JBS_TITLE_MEDIA_FILES');
</codefragment>
  </duplication>
  <duplication lines="18" tokens="72">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/messagelist/view.html.php" line="157"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/sermons/view.html.php" line="480"/>
    <codefragment>        $title = $this-&gt;params-&gt;def('page_title', '');
        $title .= ' : ' . JText::_('JBS_CMN_MESSAGES_LIST');

        if ($app-&gt;getCfg('sitename_pagetitles', 0) == 1)
        {
            $title = JText::sprintf('JPAGETITLE', $app-&gt;getCfg('sitename'), $title);
        }
        elseif ($app-&gt;getCfg('sitename_pagetitles', 0) == 2)
        {
            $title = JText::sprintf('JPAGETITLE', $title, $app-&gt;getCfg('sitename'));
        }
        $this-&gt;document-&gt;setTitle($title);

        $pathway = $app-&gt;getPathWay();
        $pathway-&gt;addItem($title, '');

        if ($this-&gt;params-&gt;get('menu-meta_description'))
        {
</codefragment>
  </duplication>
  <duplication lines="30" tokens="102">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/seriesdisplay/view.html.php" line="144"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/teacher/view.html.php" line="162"/>
    <codefragment>        foreach ($studies AS $i =&gt; $study)
        {
            $pelements               = $pagebuilder-&gt;buildPage($study, $params, $this-&gt;admin_params);
            $studies[$i]-&gt;scripture1 = $pelements-&gt;scripture1;
            $studies[$i]-&gt;scripture2 = $pelements-&gt;scripture2;
            $studies[$i]-&gt;media      = $pelements-&gt;media;
            $studies[$i]-&gt;duration   = $pelements-&gt;duration;
            $studies[$i]-&gt;studydate  = $pelements-&gt;studydate;
            $studies[$i]-&gt;topics     = $pelements-&gt;topics;

            if (isset($pelements-&gt;study_thumbnail))
            {
                $studies[$i]-&gt;study_thumbnail = $pelements-&gt;study_thumbnail;
            }
            else
            {
                $studies[$i]-&gt;study_thumbnail = null;
            }

            if (isset($pelements-&gt;series_thumbnail))
            {
                $studies[$i]-&gt;series_thumbnail = $pelements-&gt;series_thumbnail;
            }
            else
            {
                $studies[$i]-&gt;series_thumbnail = null;
            }
            $studies[$i]-&gt;detailslink = $pelements-&gt;detailslink;

            if (isset($pelements-&gt;studyintro))
</codefragment>
  </duplication>
  <duplication lines="44" tokens="160">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/teacher/view.html.php" line="259"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/teachers/view.html.php" line="227"/>
    <codefragment>        if (empty($title))
        {
            $title = $app-&gt;getCfg('sitename');
        }
        elseif ($app-&gt;getCfg('sitename_pagetitles', 0) == 1)
        {
            $title = JText::sprintf('JPAGETITLE', $app-&gt;getCfg('sitename'), $title);
        }
        elseif ($app-&gt;getCfg('sitename_pagetitles', 0) == 2)
        {
            $title = JText::sprintf('JPAGETITLE', $title, $app-&gt;getCfg('sitename'));
        }
        $this-&gt;document-&gt;setTitle($title);

        // Prepare meta information (under development)
        if ($itemparams-&gt;get('metakey'))
        {
            $this-&gt;document-&gt;setMetadata('keywords', $itemparams-&gt;get('metakey'));
        }
        elseif ($this-&gt;params-&gt;get('menu-meta_keywords'))
        {
            $this-&gt;document-&gt;setMetadata('keywords', $this-&gt;params-&gt;get('menu-meta_keywords'));
        }
        else
        {
            $this-&gt;document-&gt;setMetadata('keywords', $this-&gt;admin_params-&gt;get('metakey'));
        }

        if ($itemparams-&gt;get('metadesc'))
        {
            $this-&gt;document-&gt;setDescription($itemparams-&gt;get('metadesc'));
        }
        elseif ($this-&gt;params-&gt;get('menu-meta_description'))
        {
            $this-&gt;document-&gt;setDescription($this-&gt;params-&gt;get('menu-meta_description'));
        }
        else
        {
            $this-&gt;document-&gt;setDescription($this-&gt;admin_params-&gt;get('metadesc'));
        }

        if ($this-&gt;params-&gt;get('robots'))
        {
            $this-&gt;document-&gt;setMetadata('robots', $this-&gt;params-&gt;get('robots'));
</codefragment>
  </duplication>
  <duplication lines="22" tokens="84">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/teacher/view.html.php" line="259"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/com_biblestudy/site/views/terms/view.html.php" line="120"/>
    <codefragment>        if (empty($title))
        {
            $title = $app-&gt;getCfg('sitename');
        }
        elseif ($app-&gt;getCfg('sitename_pagetitles', 0) == 1)
        {
            $title = JText::sprintf('JPAGETITLE', $app-&gt;getCfg('sitename'), $title);
        }
        elseif ($app-&gt;getCfg('sitename_pagetitles', 0) == 2)
        {
            $title = JText::sprintf('JPAGETITLE', $title, $app-&gt;getCfg('sitename'));
        }
        $this-&gt;document-&gt;setTitle($title);

        // Prepare meta information (under development)
        if ($itemparams-&gt;get('metakey'))
        {
            $this-&gt;document-&gt;setMetadata('keywords', $itemparams-&gt;get('metakey'));
        }
        elseif ($this-&gt;params-&gt;get('menu-meta_keywords'))
        {
            $this-&gt;document-&gt;setMetadata('keywords', $this-&gt;params-&gt;get('menu-meta_keywords'));
</codefragment>
  </duplication>
  <duplication lines="98" tokens="241">
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/plg_biblestudy_backup/jbsbackup.php" line="133"/>
    <file path="/Users/bcordis/PhpstormProjects/Joomla-Bible-Study/plg_biblestudy_podcast/jbspodcast.php" line="141"/>
    <codefragment>        $db-&gt;setQuery($query, 0, 1);
        $result     = $db-&gt;loadObject();
        $lasttime   = $result-&gt;timeset;
        $difference = $now - $lasttime;
        $date       = getdate($now);
        $day        = $date['wday'];
        $systemhour = $date['hours'];

        if ($params-&gt;get('offset', '0') &gt; 0)
        {
            $hour = $systemhour + $offset;
        }
        else
        {
            $hour = $systemhour;
        }

        if ($params-&gt;get('day1') == $day &amp;&amp; $params-&gt;get('hour1') == $hour &amp;&amp; $difference &gt; 3600)
        {
            $checkdays = true;
        }
        if ($params-&gt;get('day2') == $day)
        {
            if ($params-&gt;get('hour2') == $hour &amp;&amp; $difference &gt; 3600)
            {
                $checkdays = true;
            }
        }
        if ($params-&gt;get('day3') == $day)
        {
            if ($params-&gt;get('hour3') == $hour &amp;&amp; $difference &gt; 3600)
            {
                $checkdays = true;
            }
        }
        if ($params-&gt;get('day4') == $day)
        {
            if ($params-&gt;get('hour4') == $hour &amp;&amp; $difference &gt; 3600)
            {
                $checkdays = true;
            }
        }
        if ($params-&gt;get('day5') == $day)
        {
            if ($params-&gt;get('hour5') == $hour &amp;&amp; $difference &gt; 3600)
            {
                $checkdays = true;
            }
        }
        if ($params-&gt;get('day6') == $day)
        {
            if ($params-&gt;get('hour6') == $hour &amp;&amp; $difference &gt; 3600)
            {
                $checkdays = true;
            }
        }
        if ($params-&gt;get('day7') == $day)
        {
            if ($params-&gt;get('hour7') == $hour &amp;&amp; $difference &gt; 3600)
            {
                $checkdays = true;
            }
        }
        if ($params-&gt;get('day8') == $day)
        {
            if ($params-&gt;get('hour8') == $hour &amp;&amp; $difference &gt; 3600)
            {
                $checkdays = true;
            }
        }
        if ($params-&gt;get('day9') == $day)
        {
            if ($params-&gt;get('hour9') == $hour &amp;&amp; $difference &gt; 3600)
            {
                $checkdays = true;
            }
        }
        if ($params-&gt;get('day10') == $day)
        {
            if ($params-&gt;get('hour10') == $hour &amp;&amp; $difference &gt; 3600)
            {
                $checkdays = true;
            }
        }

        return $checkdays;
    }

    /**
     * Update the time
     *
     * @return boolean
     */
    public function updatetime()
    {
        $time  = time();
        $db    = JFactory::getDBO();
        $query = 'UPDATE #__jbsbackup_timeset SET `backup` = ' . $time;
</codefragment>
  </duplication>
</pmd-cpd>
